function ListComponent(t,e,i){Observable.call(this),this.id=t,this.defaultOptions={first_focus:0,loop:!1,auto_init:!1,selector:"li",active_class:"active",disabled_class:"disabled",disabled:[]},this.options=$.extend(this.defaultOptions,e),this.data=i,this.initialize()}function ScrollListComponent(t,e,i){e=$.extend({direction:"horizontal",maxFocusIndex:0},e),ListComponent.call(this,t,e,i)}function Carousel(t,e,i){ScrollListComponent.call(this,t,e,i)}function NewList(t,e,n){this.id=t,this.data=n,this.default_options={direction:"horizontal",maxFocusIndex:0,minFocusIndex:0,visible_number:4,loop:!1,auto_start:!1,initial_index:0,speed_transition:0,selector:"li",template:"ListItem",active_class:"active"},i=0,this.position=0,this.right_spaces=0,this.left_spaces=0,this.start_spaces=0,this.current_items=[],this.focus_item=!1,this.options=$.extend(this.default_options,e),this.initialize()}function Clock(t,e){if(!t)throw"Clock necesita un container";this.container=t,this.options=e||{},this.initialize(),this.interval_id=!1,this.timer=!1}function Countdown(t,e,i){this._container=document.getElementById(t),this._time=e,this.onEnd=i,this._timer=null,this.initialize()}function Grid(t,e,i){this.id=t,this._data=i,this.options={size:4,row_class:"grid-row",child_selector:".child",grid_template:"Grid",child_template:"GridItem",maxFocusIndex:0},this.list_id=this.id+"_HorizontalList",this.scroll_list_id=this.id,this.horizontal_list=!1,this.vertical_list=!1,this.press_timer=!1,this.on_focus_timer=!1,this.options=$.extend(this.options,e),this.initialize(),Observable.call(this)}function MiniCalendar(t,e){this.container=t,this.options=e||{},this.initialize()}function Observable(){this._listeners={}}function SagemEvents(){if(SagemEvents.instance)return SagemEvents.instance;Observable.call(this),this.startObserving(),SagemEvents.instance=this}window.AppActions={moveUp:"moveUp",moveDown:"moveDown",moveLeft:"moveLeft",moveRight:"moveRight",select:"select",selectReleased:"selectReleased",play:"play",pause:"pause",playPause:"playPause",fastForward:"fastForward",rewind:"rewind",stopStepping:"stopStepping",seek:"seek",stop:"stop",nextTrack:"nextTrack",prevTrack:"prevTack",backspace:"backspace",redBtn:"redBtn",greenBtn:"greenBtn",yellowBtn:"yellowBtn",blueBtn:"blueBtn",channelUp:"channelUp",channelDown:"channelDown",swapChannel:"swapChannel",volumeUp:"volumeUp",volumeDown:"volumeDown",mute:"mute",back:"back",menu:"menu",exit:"exit",search:"search",delete:"delete",guide:"guide",qaControl:"1",qaControl2:"2",qaControl3:"3",qaControl4:"4",qaControl5:"5",qaControl6:"6",qaControl7:"7",qaControl8:"8",qaControl9:"9",qaControl0:"0",netflix:"netflix",vod:"vod",isMovementAction:function(t){return stringHelper.startsWith(t,"move")},isLeftRightAction:function(t){return t==this.moveLeft||t==this.moveRight},isQaAction:function(t){return stringHelper.startsWith(t,"qaControl")},isCoreAction:function(t){return t&&!this.isQaAction(t)}},window.ActionHandler=function(){function i(i,n){$(document.body).bind("keydown",function(t){var e=t.keyCode,e=n?t:function(t){var e,i,n=o();for(i in n){var s=n[i];if($.isNumeric(s)&&s==t||Array.isArray(s)&&0<=s.indexOf(t)){e=i;break}}return e}(e);e=e||t.key,"function"==typeof i&&"string"==typeof e&&i.call(null,e)})}var e={space:32,enter:13,esc:27,del:127,backspace:8,one:49,two:50,three:51,four:52,five:53,six:54,seven:55,eight:56,nine:57,zero:48,menu:462,guide:458,A:65,S:83,D:68,F:70,P:80,Z:90,channelUp:427,channelDown:428,swapChannel:114,redBtn:403,greenBtn:404,yellowBtn:405,blueBtn:406,leftArrow:37,rightArrow:39,upArrow:38,downArrow:40,netflix:113,vod:623,volumeUp:447,volumeDown:448,mute:449},o=function(){(t={})[AppActions.moveLeft]=e.leftArrow,t[AppActions.moveRight]=e.rightArrow,t[AppActions.moveUp]=e.upArrow,t[AppActions.moveDown]=e.downArrow,t[AppActions.select]=e.enter,t[AppActions.menu]=e.menu,t[AppActions.guide]=e.guide,t[AppActions.backspace]=[e.esc,e.backspace,e.del,e.backspace2],t[AppActions.qaControl]=e.one,t[AppActions.qaControl2]=e.two,t[AppActions.qaControl3]=e.three,t[AppActions.qaControl4]=e.four,t[AppActions.qaControl5]=e.five,t[AppActions.qaControl6]=e.six,t[AppActions.qaControl7]=e.seven,t[AppActions.qaControl8]=e.eight,t[AppActions.qaControl9]=e.nine,t[AppActions.qaControl0]=e.zero,t[AppActions.channelUp]=e.channelUp,t[AppActions.channelDown]=e.channelDown,t[AppActions.swapChannel]=e.swapChannel,t[AppActions.volumeUp]=e.volumeUp,t[AppActions.volumeDown]=e.volumeDown,t[AppActions.redBtn]=e.redBtn,t[AppActions.greenBtn]=e.greenBtn,t[AppActions.yellowBtn]=e.yellowBtn,t[AppActions.blueBtn]=e.blueBtn,t[AppActions.netflix]=e.netflix,t[AppActions.vod]=e.vod,t[AppActions.mute]=e.mute;var t;return t[AppActions.playPause]=[415,19,463],t[AppActions.fastForward]=417,t[AppActions.rewind]=412,t[AppActions.stop]=413,t[AppActions.prevTrack]=424,t[AppActions.nextTrack]=425,t[AppActions.back]=461,t};return{addCallback:function(t,e){i(t,e)},removeCallback:function(t){t=t,$(document.body).unbind("keydown",t)}}}(),ListComponent.prototype=Object.create(Observable.prototype),ListComponent.prototype.initialize=function(){this.container=$("#"+this.id),this.items=this.container.find("> "+this.options.selector),this.length=this.items.length,this.setData(this.data),this.options.auto_init&&this.setFocusIndex(this.options.first_focus),0<this.options.disabled.length&&this.disableItems()},ListComponent.prototype.reInitialize=function(t){this.data=t,this.initialize()},ListComponent.prototype.disableItems=function(){this.items.removeClass(this.options.disabled_class);for(var t=0;t<this.options.disabled.length;t++)$(this.items[this.options.disabled[t]]).addClass(this.options.disabled_class)},ListComponent.prototype.setDisabledItems=function(t){this.options.disabled=t=t||[],this.disableItems()},ListComponent.prototype.setFocusIndex=function(t,e){if((t=void 0===t&&"number"==typeof this.lastFocus?this.lastFocus:t)<0||t>=this.length){if(!e)return!1;t=this.length-1}return!(0<=$.inArray(t,this.options.disabled)||(this.focusCallback(!1),this.currentFocusIndex=t,this.updateList(),this.focusCallback(!0),0))},ListComponent.prototype.focusCallback=function(t){var e;this.fire("event",{data:"algo"}),"function"==typeof this.options.onFocus&&"number"==typeof this.currentFocusIndex&&(e=this.getFocusItem(),this.options.onFocus(t,e))},ListComponent.prototype.updateList=function(){this.items.removeClass(this.options.active_class);var t=$(this.items[this.currentFocusIndex]),e=this;clearTimeout(this._test),this._test=setTimeout(function(){clearTimeout(e._test),t.addClass(e.options.active_class)},200)},ListComponent.prototype.nextItem=function(){for(var t=this.currentFocusIndex+1;0<=$.inArray(t,this.options.disabled);)t++;this.setNextPosition(t)},ListComponent.prototype.previousItem=function(){for(var t=this.currentFocusIndex-1;0<=$.inArray(t,this.options.disabled);)t--;this.setNextPosition(t)},ListComponent.prototype.setData=function(t){if(Array.isArray(t))for(var e=(this.data=t).length-1;0<=e;e--)$(this.items[e]).data("data",t[e])},ListComponent.prototype.getLastFocusData=function(){return this.data[this.lastFocus]},ListComponent.prototype.getFocusData=function(){return this.data[this.currentFocusIndex]},ListComponent.prototype.setNextPosition=function(t){switch(!0){case 0<=t&&t<this.length:this.setFocusIndex(t);break;case this.options.loop&&t>=this.length:this.setFocusIndex(0);break;case this.options.loop&&t<=0:this.setFocusIndex(this.length-1);break;case!this.options.loop&&t>=this.length:case!this.options.loop&&t<0:return}},ListComponent.prototype.getId=function(){return this.id},ListComponent.prototype.getContainer=function(){return this.container},ListComponent.prototype.getFocusItem=function(){return this.items.eq(this.currentFocusIndex)},ListComponent.prototype.resetItems=function(){this.items=this.container.find("> "+this.options.selector)},ListComponent.prototype.getItem=function(t){return this.items.eq(t)},ListComponent.prototype.getItems=function(){return this.items},ListComponent.prototype.getFocusIndex=function(){return this.currentFocusIndex},ListComponent.prototype.getLastFocusIndex=function(){return this.lastFocus},ListComponent.prototype.getLastFocusItem=function(){return $(this.items[this.lastFocus])},ListComponent.prototype.hasFocus=function(){return"number"==typeof this.currentFocusIndex},ListComponent.prototype.offFocus=function(){if("number"==typeof this.currentFocusIndex)return this.focusCallback(!1),this.lastFocus=this.currentFocusIndex,this.currentFocusIndex=!1,this.items.removeClass(this.options.active_class),this.lastFocus},ListComponent.prototype.cleanUp=function(){delete this.options.onFocus,this.items.removeData(),this.items.remove(),this.container.empty(),this.container.html("")},ScrollListComponent.prototype=Object.create(ListComponent.prototype),ScrollListComponent.prototype.initialize=function(){var t=this.options.auto_init;this.options.auto_init=!1,ListComponent.prototype.initialize.call(this),this.setAdjustSize(),this.options.auto_init=t,this.options.auto_init&&this.setFocusIndex(this.options.first_focus),this.calcPositions()},ScrollListComponent.prototype.setAdjustSize=function(){var t=this.items.first(),t="horizontal"===this.options.direction?t.outerWidth(!0):t.outerHeight(!0);this.adjustSize=t},ScrollListComponent.prototype.setFocusIndex=function(t){!0===ListComponent.prototype.setFocusIndex.call(this,t)&&this.setPosition()},ScrollListComponent.prototype.calcPositions=function(){this.positions={};for(var t=0,e=0;e<this.items.length;e++){var i=$(this.items[e]);e>this.options.maxFocusIndex&&(this.options.item_size?t+=i.outerWidth(!0):t+=this.adjustSize),this.positions[e]=Math.round(-1*t)}},ScrollListComponent.prototype.setPosition=function(){if(!this.positions)return!1;var t=this.positions[this.currentFocusIndex],t="horizontal"===this.options.direction?"translate3d("+t+"px, 0, 0)":"translate3d( 0, "+t+"px, 0)";this.container.css("transform",t)},Carousel.prototype=Object.create(ScrollListComponent.prototype),Carousel.prototype.initialize=function(){ListComponent.prototype.initialize.call(this),this.n_clones=this.options.n_clones||0,this.cloneItems(),this.setAdjustSize(),this.calcPositions()},Carousel.prototype.setFocusIndex=function(t){if(t>=this.length-this.n_clones)return!1;"number"==typeof t?t+=this.n_clones:"number"==typeof this.lastFocus&&(t=this.lastFocus+this.n_clones),ScrollListComponent.prototype.setFocusIndex.call(this,t)},Carousel.prototype.setNextPosition=function(t){switch(!0){case this.isCarousel&&t<this.n_clones:this.removeTransition(),ScrollListComponent.prototype.setFocusIndex.call(this,this.length-this.n_clones),window.setTimeout(function(){this.revertTransition(),ScrollListComponent.prototype.setFocusIndex.call(this,this.length-this.n_clones-1)}.bind(this),0);break;case 0<=t&&t<this.length-this.n_clones:ScrollListComponent.prototype.setFocusIndex.call(this,t);break;case this.isCarousel&&t>=this.length-this.n_clones:this.removeTransition(),ScrollListComponent.prototype.setFocusIndex.call(this,this.n_clones-1),window.setTimeout(function(){this.revertTransition(),ScrollListComponent.prototype.setFocusIndex.call(this,this.n_clones)}.bind(this),0)}},Carousel.prototype.removeTransition=function(){(container=this.getContainer()).css("transition","none")},Carousel.prototype.revertTransition=function(){(container=this.getContainer()).css("transition","")},Carousel.prototype.cloneItems=function(){if(!(this.length<1)){for(var t,e=this.getContainer(),i=0;i<this.n_clones;)t=this.getItem(i).clone(),e.append(t),1===this.length&&this.resetItems(),this.getItem(this.length-1-i).clone(),e.prepend(this.getItem(this.length-1-i).clone()),i++;this.items=this.container.find("> "+this.options.selector),this.length=this.items.length,0<this.options.n_clones?this.isCarousel=!0:this.isCarousel=!1}},Carousel.prototype.setNClones=function(t){"number"==typeof t&&(this.options.n_clones=t)},Carousel.prototype.offFocus=function(){return"number"==typeof this.currentFocusIndex&&(this.focusCallback(!1),this.lastFocus=this.currentFocusIndex-this.n_clones,this.currentFocusIndex=!1,this.items.removeClass(this.options.active_class),this.lastFocus)},Carousel.prototype.getLastFocusItem=function(){return $(this.items[this.lastFocus+this.n_clones])},NewList.prototype.setData=function(t){this.data=t},NewList.prototype.initialize=function(){var t,e=this.options.initial_index,i=!1;if(this.right_spaces=0,this.left_spaces=0,this.length=this.data.length,this.container=$("#"+this.id),this.container.html(""),this.current_items=this.prepareItems(this.options.minFocusIndex),0<(t=this.getLastEmptyValues(this.current_items))&&this.length>this.options.visible_number&&(this.options.initial_index=this.length-this.options.visible_number+1,this.current_items=this.prepareItems(this.options.minFocusIndex)),this.fillItems(),this.setItemSize(),this.setPositions(),this.setIndexes(),this.current_items.indexOf(this.options.initial_index)>this.options.maxFocusIndex&&(i=!0,e=this.options.initial_index,this.options.initial_index=this._getFirstIndex(),this.setIndexes()),t&&this.length>this.options.visible_number||i)for(;this.getFocusIndex()<e;)this.nextItem()},NewList.prototype._getFirstIndex=function(){for(var t,e=this.current_items.length,i=0;i<e;){if("number"==typeof(t=this.current_items[i]))return t;i++}},NewList.prototype.getLastEmptyValues=function(t){for(var e=0,i=t.length-1;0<=i&&!1===t[i];i--)e++;return e},NewList.prototype.setIndexes=function(){i=this.options.initial_index,this.current_index=this.current_items.indexOf(i),this.options.auto_start&&this.doSetFocusIndex(i)},NewList.prototype.prepareItems=function(t){var e=[],i=this.options.initial_index-t,n=[],s=0,o=i;for(this.options.visible_number,this.data.length;s<this.options.visible_number;){var r=this.getDataIndex(o);"number"==typeof r&&n.push(r),s++,o++}if(n.length!==this.options.visible_number){switch(!0){case this.options.loop&&i<0:e=this.getLastItemsIndexes(Math.abs(i));break;case!this.options.loop&&i<0:e=this.getEmptyIndexes(Math.abs(i))}if((n=e.concat(n)).length!==this.options.visible_number){if(t=this.options.visible_number-n.length,!this.options.loop)return n=n.concat(this.getEmptyIndexes(t));0<t&&(e=this.getFirstIndexes(t),n=n.concat(e))}}return n},NewList.prototype.getDataIndex=function(t){return!!this.data[t]&&t},NewList.prototype.getDataIndexes=function(){return this.data.map(function(t,e){return e})},NewList.prototype.getLastItemsIndexes=function(t){for(var e=this.getDataIndexes(),i=[];e.length<t;)e=e.concat(this.getDataIndexes());for(var n=e.length-1;0<=n;n--)if(i.unshift(e[n]),i.length===t)return i},NewList.prototype.getFirstIndexes=function(t){for(var e=this.getDataIndexes(),i=[];e.length<t;)e=e.concat(this.getDataIndexes());for(var n=0;n<e.length;n++)if(i.push(e[n]),i.length===t)return i},NewList.prototype.getEmptyIndexes=function(t){for(var e=[],i=0;i<t;)e.push(!1),i++;return e},NewList.prototype.setSizeUnit=function(){var t=this.options.item_size;this.size_unit=this.options.item_size?t.replace(/^[+-]?\d+(\.\d+)?/g,""):"px"},NewList.prototype.setItemSize=function(){var t;this.setSizeUnit(),this.options.item_size?this.item_size=parseFloat(this.options.item_size):(t=this.items.eq(0),"horizontal"===this.options.direction?this.item_size=t.outerWidth(!0)+"px":this.item_size=t.outerHeight(!0)+"px")},NewList.prototype.getNextIndex=function(t){var e=this.data.length;return 1!==e&&t<=e-2?t+1:0},NewList.prototype.fillItems=function(){for(var t,e,i="",n=0,s=0;s<this.current_items.length;s++)!1===(t=this.current_items[s])&&0===n?(this.start_spaces++,this.left_spaces++):!1===t&&0<n?this.right_spaces++:(n++,(e=this.data[t]).index=t,i+=Templates[this.options.template](e));this.container.html(i),this.updateItems()},NewList.prototype.updateItems=function(){this.items=this.container.find(this.options.selector)},NewList.prototype.setPosition=function(t,e){"horizontal"===this.options.direction?t.style.transform="translate3d("+e+this.size_unit+", 0, 0)":t.style.transform="translate3d(0, "+e+this.size_unit+", 0)",t.setAttribute("data-position",e)},NewList.prototype.setPositions=function(){for(var t,e=this.items.length,i=0;i<e;i++)this.items[i]&&(t=i*this.item_size+this.left_spaces*this.item_size,this.setPosition(this.items[i],t))},NewList.prototype.doSetFocusIndex=function(t){i=t;var e=this.container.find("[data-index = "+t+"]");this.callOnFocusCallback(!1),this.items.removeClass(this.options.active_class),e.addClass(this.options.active_class),this.focus_item=e,this.callOnFocusCallback(!0,e,t)},NewList.prototype.callOnFocusCallback=function(t,e,n){"function"==typeof this.options.onFocus&&(e||(e=this.container.find("."+this.options.active_class),n=i),setTimeout(this.options.onFocus.bind(!1,t,e,this.data[n]),0))},NewList.prototype.setFocusIndex=function(t){void 0===(t=void 0===t?this.last_focus:t)&&(t=this.options.initial_index),this.current_items.indexOf(t),this.current_items.indexOf(t)<0&&(this.options.initial_index=t,this.current_items=this.prepareItems(this.options.minFocusIndex),this.fillItems(),this.setPositions(),this.setIndexes()),this.doSetFocusIndex(t)},NewList.prototype.nextItem=function(){var t=this.getNextIndex(i);!this.options.loop&&t<=i||(this.current_index>=this.options.minFocusIndex&&this.current_index<this.options.maxFocusIndex?(i=t,this.current_index++,this.doSetFocusIndex(i)):(this.doSetFocusIndex(t),this.makeNextItem(),i=t))},NewList.prototype.makeNextItem=function(){this.items.length;for(var t,e,i,n=this.current_items[this.current_items.length-1],s=this.getNextIndex(n),o=0;o<this.items.length;o++)t=this.items[o],e=parseFloat(t.getAttribute("data-position"))-this.item_size,this.setPosition(t,i=e);!1!==n&&(this.options.loop||0!==s?(this.current_items.shift(),this.current_items.push(s),n=this.insertNextItem(s),this.setPosition(n[0],i+this.item_size),this.left_spaces?this.left_spaces--:setTimeout(this.removeFirstItem.bind(this),this.options.speed_transition)):this.right_spaces++)},NewList.prototype.afterNextTransition=function(){this.removeFirstItem()},NewList.prototype.getPreviousIndex=function(t){var e=this.data.length;return t?t-1:e-1},NewList.prototype.previousItem=function(){var t=this.getPreviousIndex(i);!this.options.loop&&t===this.data.length-1||(this.current_index<=this.options.maxFocusIndex&&this.current_index>this.options.minFocusIndex?(i=t,this.current_index--,console.log("previousItem: ",i,this.current_index),this.doSetFocusIndex(t)):(this.makePreviousItem(),this.doSetFocusIndex(t),this.index=t))},NewList.prototype.makePreviousItem=function(){for(var t,e=this.items.length,i=this.current_items[0],n=this.getPreviousIndex(this.current_items[0]),s=0;s<e;s++)t=this.items[s],current_pos=parseFloat(t.getAttribute("data-position")),next_pos=current_pos+this.item_size,this.setPosition(t,next_pos);!1!==i&&(this.right_spaces&&!this.hasEmptyItems()?this.right_spaces--:this.options.loop||this.data.length-1!==n?(this.hasEmptyItems()?this.right_spaces--:setTimeout(this.removeLastItem.bind(this),this.options.speed_transition),this.current_items.pop(),this.current_items.unshift(n),first=this.insertPreviousItem(n),this.setPosition(first[0],0)):(this.left_spaces++,this.current_items.pop(),this.current_items.unshift(!1),setTimeout(this.removeLastItem.bind(this),this.options.speed_transition)))},NewList.prototype.removeFirstItem=function(){this.items.first().remove(),this.updateItems()},NewList.prototype.removeLastItem=function(){this.items.last().remove(),this.updateItems()},NewList.prototype.insertNextItem=function(t){var e=this.data[this.current_items[this.current_items.length-1]],t=(e.index=t,Templates[this.options.template](e));return this.container.append(t),this.updateItems(),this.items.last()},NewList.prototype.insertPreviousItem=function(t){var e=this.data[this.current_items[0]],t=(e.index=t,Templates[this.options.template](e));return this.container.prepend(t),this.updateItems(),this.items.first()},NewList.prototype.hasEmptyItems=function(){return 0<this.current_items.indexOf(!1)},NewList.prototype.getFocusIndex=function(){return parseInt(this.focus_item.attr("data-index"))},NewList.prototype.getFocusData=function(){return this.data[this.getFocusIndex()]},NewList.prototype.offFocus=function(){return this.callOnFocusCallback(!1),this.last_focus=this.index,this.last_selected_focus=this.current_items,this.items.removeClass(this.options.active_class),this.last_focus},NewList.prototype.getLastFocus=function(){return this.last_focus},NewList.prototype.getFocusItem=function(){return this.focus_item},NewList.prototype.getSelectedIndex=function(){return this.current_index},NewList.prototype.getCurrentItemsSelectedIndex=function(){return this.current_items.indexOf(this.index)},NewList.prototype.setSelectedIndex=function(t){return!(t<this.options.minFocusIndex||t>this.options.maxFocusIndex||(this.current_index=t,this.right_spaces&&(t+=this.right_spaces),t=this.current_items[t],this.setFocusIndex(t),0))},NewList.prototype.toFirstItem=function(){for(var t=this.getFocusIndex()-1;0<=t;t--)this.previousItem()},NewList.prototype.cleanUp=function(){this.options&&(delete this.options.onFocus,delete this.options),this.container.empty(),this.items.removeData(),this.items.remove(),this.container.html("")},NewList.prototype.getContainer=function(){return this.container},Clock.prototype.initialize=function(){var t=this.setTime(!0);t&&(this.timer=setTimeout(this.extendInterval.bind(this),6e4-1e3*t))},Clock.prototype.restart=function(){window.clearInterval(this.interval_id),window.clearTimeout(this.timer),this.initialize()},Clock.prototype.extendInterval=function(){this.setTime(),this.setInterval()},Clock.prototype.setTime=function(){var t=new Date,e=t.getHours(),i=t.getMinutes(),t=t.getSeconds();return this.container.html(this.formatHour(e,i)),t},Clock.prototype.formatHour=function(t,e){return(t=t<10?"0"+t:t)+":"+(e=e<10?"0"+e:e)+(this.options.complement?" "+this.options.complement:"")},Clock.prototype.setInterval=function(){this.interval_id=window.setInterval(this.setTime.bind(this),6e4)},Clock.prototype.destroy=function(){window.clearInterval(this.interval_id)},Clock.prototype.cleanIntervals=function(){window.clearInterval(this.interval_id),window.clearTimeout(this.timer)},Countdown.prototype.initialize=function(){hours=Math.floor(this._time/1e3/60/60),864e5<this._time&&this.getDays(hours),this._timer=window.setInterval(this.onSecond.bind(this),1e3)},Countdown.prototype.onSecond=function(){var t;this._time=this._time-1e3,t=this.getTime(this._time),this._time<864e5&&(this._container.innerHTML=t)},Countdown.prototype.getDays=function(t){t=Math.floor(t*(1/24));this._container.innerHTML="&nbsp"+t+"&nbspdías"},Countdown.prototype.getTime=function(t){var e;return t<=0?(this.stop(),this.onEnd(),"00:00:00"):((e=Math.floor(t/1e3/60/60))<10?"0"+e:e)+":"+((e=Math.floor(t/1e3/60%60))<10?"0"+e:e)+":"+((e=Math.floor(t/1e3%60))<10?"0"+e:e)},Countdown.prototype.stop=function(){this._timer&&window.clearInterval(this._timer)},Grid.prototype=Object.create(Observable.prototype),Grid.prototype.setData=function(t,e){e&&(this.options=$.extend(this.options,e)),this._data=t,this.vertical_list=!1,this.horizontal_list=!1,this.press_timer=!1,this.initialize()},Grid.prototype.initialize=function(){this.container=$("#"+this.id),this.length=this._data.length,this.current_data=this.prepareData(this._data),this.renderGrid(this.current_data),this.initComponents()},Grid.prototype.renderGrid=function(t){t={rows:t,row_class:this.options.row_class},t=this.getHtmlGrid(t);this.container.html(""),this.doRenderGrid(t)},Grid.prototype.doRenderGrid=function(t){this.container.append(t)},Grid.prototype.prepareData=function(t){for(var e,i=[];0<t.length;)e={items:t.splice(0,this.options.size),template:this.getChildTemplate.bind(this),row_class:this.options.row_class},i.push(e);return i},Grid.prototype.getChildTemplate=function(){return this.options.child_template},Grid.prototype.getHtmlGrid=function(t){return Templates[this.options.grid_template](t)},Grid.prototype.initComponents=function(){var t={selector:"."+this.options.row_class,direction:"vertical",maxFocusIndex:this.options.maxFocusIndex,onFocus:this.onRowFocus.bind(this)},e={selector:this.options.child_selector};this.vertical_list=new ScrollListComponent(this.scroll_list_id,t),this.horizontal_list=new ListComponent(this.list_id,e),this.horizontal_list.lastFocus=0,this.vertical_list.setFocusIndex(0)},Grid.prototype.actionHandler=function(t){var e;switch(t){case AppActions.moveUp:0===this.vertical_list.getFocusIndex()?this.options.goUp&&(window.setTimeout(this.offFocus.bind(this),0),this.fire("leave_focus")):this.vertical_list.previousItem();break;case AppActions.moveDown:this.vertical_list.getFocusIndex()===this.current_data.length-2&&this.fire("end_grid"),this.vertical_list.nextItem();break;case AppActions.moveLeft:this.horizontal_list.previousItem();break;case AppActions.moveRight:this.horizontal_list.nextItem();break;case AppActions.select:e=this.horizontal_list.getFocusData(),this.fire("selected_item",{item:e})}},Grid.prototype.onRowFocus=function(t,e){var i;window.clearTimeout(this.on_focus_timer),t?(e.attr("id",this.list_id),i=this.vertical_list.getFocusIndex(),i=this.current_data[i].items,window.clearTimeout(this.press_timer),this.press_timer?this.press_timer=window.setTimeout(this.reInitList.bind(this,i),80):(this.press_timer=!0,this.reInitList(i))):(this.horizontal_list.offFocus(),e.removeAttr("id")),t&&this.options.onFocus&&(this.on_focus_timer=window.setTimeout(this.options.onFocus,100))},Grid.prototype.reInitList=function(t){this.horizontal_list.reInitialize(t),this.horizontal_list.setFocusIndex(void 0,!0)},Grid.prototype.appendData=function(t){var e=this.vertical_list.getFocusIndex(),i=this.current_data[this.current_data.length-1],n=this.options.size-i.items.length;n&&(t=this.completeLastRow(t,n,i.items),e===this.current_data.length-1)&&this.reInitList(this.current_data[this.current_data.length-1].items),t=this.prepareData(t),this.current_data=this.current_data.concat(t),this.doAppendData(t),this.vertical_list.reInitialize()},Grid.prototype.doAppendData=function(t){t={rows:t,row_class:this.options.row_class},t=this.getHtmlGrid(t);this.doRenderGrid(t)},Grid.prototype.appendToLastRow=function(t){for(var e=this.vertical_list.items[this.vertical_list.length-1],i="",n=0;n<t.length;n++)i+=Templates[this.options.child_template](t[n]);e.innerHTML=e.innerHTML+i},Grid.prototype.completeLastRow=function(t,e,i){e=t.splice(0,e);return this.appendToLastRow(e),this.current_data[this.current_data.length-1].items=i.concat(e),t},Grid.prototype.offFocus=function(){this.horizontal_list.offFocus()},Grid.prototype.setFocusIndex=function(){this.horizontal_list.setFocusIndex(),focus&&this.options.onFocus&&(this.on_focus_timer=window.setTimeout(this.options.onFocus,100))},Grid.prototype.getFocusItem=function(){return this.horizontal_list.getFocusData()},Grid.prototype.getHorizontalFocusIndex=function(){return this.horizontal_list.getFocusIndex()},Grid.prototype.getFocusIndex=function(){return this.vertical_list.getFocusIndex()},Grid.prototype.getContainer=function(){return this.container},Grid.prototype.getRowsLength=function(){return this.vertical_list.length},MiniCalendar.prototype.initialize=function(){this.setDate();var t=Date.now(),t=this.getTomorrow()-t;this.timerDate=window.setTimeout(this.extendInterval.bind(this),t)},MiniCalendar.prototype.restart=function(){window.clearInterval(this.intervalDate),window.clearTimeout(this.timerDate),this.initialize()},MiniCalendar.prototype.extendInterval=function(){this.setDate(),this.setInterval()},MiniCalendar.prototype.getTomorrow=function(){var t=new Date;return t.setDate(t.getDate()+1),t.setMilliseconds(0),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t},MiniCalendar.prototype.getDayName=function(t){return["domingo","lunes","martes","miércoles","jueves","viernes","sabado"][t]},MiniCalendar.prototype.getMonthName=function(t){return["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][t]},MiniCalendar.prototype.getMiniMonth=function(t){return this.getMonthName(t).substring(0,3)},MiniCalendar.prototype.getMiniDayName=function(t){return this.getDayName(t).substring(0,3)},MiniCalendar.prototype.getMiniDateString=function(t,e,i){return this.getMiniDayName(e)+" "+t+", "+this.getMiniMonth(i)},MiniCalendar.prototype.getTpsgDate=function(t,e,i){return this.getDayName(t)+" "+e+" "+this.getMiniMonth(i)},MiniCalendar.prototype.get4Date=function(t,e,i){return this.getMiniDayName(t)+" "+e+" "+this.getMiniMonth(i)},MiniCalendar.prototype.getStringDate=function(){var t=new Date,e=t.getDate(),i=t.getDay(),n=t.getMonth(),s=t.getFullYear();switch(this.options.format){case"minidate":return this.getMiniDateString(e,i,n);case"tpsg":return this.getTpsgDate(i,e,n);case"4":return this.get4Date(i,e,n);default:return this.getDayName(i)+" "+e+" de "+this.getMonthName(n)+" del "+s}},MiniCalendar.prototype.setDate=function(){var t=this.getStringDate();this.container.html(t)},MiniCalendar.prototype.setInterval=function(){this.intervalDate=window.setInterval(this.setDate.bind(this),864e5)},MiniCalendar.prototype.cleanIntervals=function(){window.clearInterval(this.intervalDate),window.clearTimeout(this.timerDate)},Observable.prototype.observe=function(t,e){void 0===this._listeners[t]&&(this._listeners[t]=[]),this._listeners[t].push(e)},Observable.prototype.fire=function(t,e){if("string"!=typeof t)throw"El evento no es un string";if(Array.isArray(this._listeners[t]))for(var i=this._listeners[t].length-1;0<=i;i--)this._listeners[t][i].call(this,e)},Observable.prototype.stopObserving=function(t,e){if(void 0!==this._listeners[t])for(var i=this._listeners[t].length-1;0<=i;i--)this._listeners[t][i]===e&&(this._listeners=this.removeItemFromArr(this._listeners[t],this._listeners[t]))},Observable.prototype.stopEventObserving=function(t){"object"==typeof this._listeners[t]&&delete this._listeners[t]},Observable.prototype.removeItemFromArr=function(t,e){return t.filter(function(t){return t!==e})},Observable.prototype.destroyListeners=function(){delete this._listeners,this._listeners={}},SagemEvents.prototype=Object.create(Observable.prototype),SagemEvents.prototype.events={DISCONNECTED:"9000D106",CONNECTED:"9000D105",NETFLIX_DIAL:"9000A002",EXIT_NETFLIX_UI:"9000A006",EXIT_NETFLIX:"9000A003",YOUTUBE_DIAL:"9000A000",UPDATE_UI:"9000A004",STANDBY_ON:"9000001C",STANDBY_OFF:"9000001B"},SagemEvents.prototype.KEY_CODES={9e3:"SESSION_START",9001:"SESSION_DIED",9002:"MANY_SESSIONS",9020:"STREAM_START",9022:"SESSION_END",1093:"LIVE_START",1051:"LIVE_STREAM_START",9003:"ERROR",9105:"ERROR",9100:"ERROR",9102:"ERROR",9103:"ERROR",9202:"ERROR",9206:"ERROR"},SagemEvents.getInstance=function(){return SagemEvents.instance||(SagemEvents.instance=new SagemEvents),SagemEvents.instance},SagemEvents.prototype.startObserving=function(){Sagem.addListener(this.eventHandler.bind(this))},SagemEvents.prototype.eventHandler=function(t){try{e=t.toString(16).toUpperCase()}catch(t){}switch(e){case this.events.EXIT_NETFLIX:case this.events.EXIT_NETFLIX_UI:return console.log("EXIT_NETFLIX",t),this.fire("EXIT_NETFLIX");case this.events.DISCONNECTED:return console.log("DISCONNECTED",t),this.fire("DISCONNECTED");case this.events.CONNECTED:return console.log("CONNECTED",t),this.fire("CONNECTED");case this.events.NETFLIX_DIAL:return this.fire("NETFLIX_DIAL");case this.events.YOUTUBE_DIAL:return this.fire("YOUTUBE_DIAL");case this.events.STANDBY_OFF:return this.fire("STANDBY_OFF");case this.events.STANDBY_ON:return this.fire("STANDBY_ON");case this.events.UPDATE_UI:return this.fire("UPDATE_UI")}var e=(268431360&t)>>12,e=parseInt(e.toString(16)),e=this.KEY_CODES[e];this.fire(e,e)};var ScrollableText=function(t,e,i){this.domElement=t,this.progress_bar=e,this.container_bar=i,this.defaultIncrement=100,this.currentPosition=0,this.incrementBar=this.getIncrement(),this.currentBar=this.getIncrement(),this.parent=t.parent(),this.parentProgress=e.parent(),this.canScroll=this.getParentHeight(),this.progressScroll=this.getParentHeight()};function UiComponent(t){Observable.call(this),this.data=t||{},this.data.id=this.name,this._storage={}}function UiManager(){if(UiManager.instance)return UiManager.instance;this.components={},this.count=0,this._stack=[],this._navStack=[],UiManager.instance=this}function VideoSession(t){this.sagem=Sagem,this.name=t,Observable.call(this),this.type_player="AVPLAYER",this.observePlayer(),this.create(),this.options={startPosition:!1,coords:!1},this.started=!1,this.current_sub_iso="und",this.posible_options={la_url:"drm_la_url",parser:"AVPARSER",token:"drm_ticket"},this._subtitles=null}function View(t){Observable.call(this),this.prepareData(t)}function ViewManager(){if(ViewManager.instance)return ViewManager.instance;this.views={},this.error_template="error",this.main_container="#mainContainer",this.error_container="#errorContainer",this.mini_error=!1,this._critical_error=!1,this._current_view=!1,this._loading=!1,ViewManager.instance=this}ScrollableText.prototype.getHeight=function(){return this.domElement.outerHeight()},ScrollableText.prototype.getWidth=function(){return this.domElement.outerWidth()},ScrollableText.prototype.getHeightBar=function(){return this.progress_bar.outerHeight()},ScrollableText.prototype.getHeightContainerBar=function(){return this.container_bar.height()},ScrollableText.prototype.getParentHeight=function(){return this.parentHeight||(this.parentHeight=this.parent.outerHeight()),this.parentHeight},ScrollableText.prototype.getIncrement=function(){return this.getHeight()/600},ScrollableText.prototype.getParentProgressHeight=function(){return this.parentProgressHeight||(this.parentProgressHeight=this.parentProgress.outerHeight()),this.parentProgressHeight},ScrollableText.prototype.getVector=function(t){switch(t){case"up":this.currentPosition<0&&(this.currentPosition+=this.defaultIncrement,this.canScroll-=this.defaultIncrement);break;case"down":this.canScroll<=this.getHeight()&&(this.currentPosition-=this.defaultIncrement,this.canScroll+=this.defaultIncrement)}return this.currentPosition+"px"},ScrollableText.prototype.getProgressBar=function(t){var e,i;switch(t){case"up":this.currentPosition<0&&(i=this.currentPosition/this.getHeight(),e=(this.getHeightBar()-this.getHeightContainerBar())*i);break;case"down":this.canScroll<=this.getHeight()&&(console.log(this.currentPosition),i=this.currentPosition/this.getHeight(),e=(this.getHeightBar()-this.getHeightContainerBar())*i)}return e+"px"},ScrollableText.prototype.doMove=function(t){t=this.getVector(t);this.domElement.css("transform","translate3d(0,"+t+",0)")},ScrollableText.prototype.doMoveProgressbar=function(t){t=this.getProgressBar(t);this.progress_bar.css("transform","translate3d(0,"+t+",0)")},ScrollableText.prototype.actionHandler=function(t){switch(t){case AppActions.moveUp:this.doMove("up"),this.doMoveProgressbar("up");break;case AppActions.moveDown:this.doMove("down"),this.doMoveProgressbar("down")}},UiComponent.prototype=Object.create(Observable.prototype),UiComponent.prototype.name="UiComponent",UiComponent.prototype.setData=function(t){this.data=t},UiComponent.prototype.getData=function(){return this.data},UiComponent.prototype.setAttribute=function(t,e){this._storage[t]=null,this._storage[t]=e},UiComponent.prototype.getAttribute=function(t){return this._storage[t]},UiComponent.prototype.getTemplate=function(t){return Templates[this.name](t)},UiComponent.prototype.doRender=function(t){return this.getTemplate(t)},UiComponent.prototype.render=function(){return this.doRender(this.data)},UiComponent.prototype.toString=function(){return this.render()},UiComponent.prototype.getContainer=function(t){return this.container&&!t||(this.container=$("#"+this.name)),this.container},UiComponent.prototype.setLoading=function(){$("#Loading").addClass("shown")},UiComponent.prototype.removeLoading=function(){$("#Loading").removeClass("shown")},UiComponent.prototype.destroy=function(){this.container.remove(),this.container=!1},UiComponent.prototype.actionHandler=function(t){throw"Debes sobreescribir este método"},UiComponent.prototype.launchError=function(t){UiManager.getInstance().launchError(t)},UiManager.prototype._referenceComponents={},UiManager.getInstance=function(){return UiManager.instance||new UiManager},UiManager.prototype.renderComponent=function(t){var e=AppConfig.main_container_selector;$(e).append(t.render())},UiManager.prototype.getComponent=function(t){return this.components[t]||(this.components[t]=new window[t]),this.components[t]},UiManager.prototype.openLink=function(t,e){console.log("Opening link",t,e);var i=t.params.id;switch(t.ref){case"category":this.openComponent("CategoryProducts",i,!0,!1,!0);break;case"image":break;case"detail":this.openComponent("ItemDetail",{productId:i},!0,!1,!0)}},UiManager.prototype.openMediaCenter=function(t){var t=t.parameters;t&&t.window&&t.baseUrl&&t.port&&(t="http://"+t.baseUrl+":"+t.port+"/Mediacenter",window.location.assign(t))},UiManager.prototype.openChild=function(t,e){this.getCurrentComponent().component.show(t)},UiManager.prototype.openReferenceComponent=function(t){t=t.ref,t=this._referenceComponents[t];ViewManager.getInstance().getCurrentView();t&&this.openComponent(t,void 0,!0)},UiManager.prototype.doHideParent=function(t,e,i){var n=this.getCurrentComponent().component;n&&!i&&(t?n.onBlur():n.hide(e))},UiManager.prototype.openComponent=function(t,e,i,n,s,o){this.doHideParent(n,s,o),this.addComponent(t,i);n=this.getCurrentComponent().component;n.show(e),n.onFocus.apply(n),this.extraThings(t)},UiManager.prototype.extraThings=function(t){ViewManager.getInstance().getCurrentView()},UiManager.prototype.closeAll=function(t){for(var e=ViewManager.getInstance().getCurrentView(),i=this._stack.length-1;0<=i;i--)this._stack[i].component.hide(t);this.count=0,this._stack=[],e&&e.onNeutralMode()},UiManager.prototype.addComponent=function(e,t){if(0<$.grep(this._stack,function(t){return t.name===e}).length)return!1;this.validateStoreState();var i=this.getComponent(e);this._stack.push({component:i,store:!!t,name:e}),++this.count},UiManager.prototype.validateStoreState=function(){var t=this.getCurrentComponent();t&&!t.store&&this.closeComponent()},UiManager.prototype.callLastComponent=function(t){var e=this.getCurrentComponent().component;e?(t?e.show:(this.extraThings(e.name),e.onFocus)).apply(e):(this.closeAll(),(t=ViewManager.getInstance().getCurrentView()).onNeutralMode&&t.onNeutralMode.apply(t))},UiManager.prototype.closeComponent=function(t,e,i){var n=this.getCurrentComponent().component;if(!n)return!1;t?n.onBlur():n.hide(),this._stack.pop(),--this.count,this.onCloseComponent(n,i),"object"==typeof i&&i.preventCallLast||this.callLastComponent(e)},UiManager.prototype.onCloseComponent=function(t,e){t=t.name;ViewManager.getInstance().getCurrentView()},UiManager.prototype.getCurrentComponent=function(t){t=t?this._navStack:this._stack;return 0!==t.length&&t.slice(-1)[0]},UiManager.prototype.inStack=function(t){this._stack.length;for(var e=0;e<this._stack.length;e++)if(this._stack[e].name===t)return!0;return!1},UiManager.prototype.getLastFocusComponent=function(){return 0!==this._stack.length&&1!==this._stack.length&&this._stack.slice(-2)[0]},UiManager.prototype.getOtherFocusComponent=function(){return 0!==this._stack.length&&1!==this._stack.length&&this._stack.slice(-4)[0]},UiManager.prototype.stackLength=function(){return this.count},UiManager.prototype.launchError=function(t){ViewManager.getInstance().launchError(t)},UiManager.setLoading=function(){$("#Loading").addClass("shown")},UiManager.removeLoading=function(){$("#Loading").removeClass("shown")},UiManager.prototype.findComponentIndex=function(t){return this._stack.map(function(t){return t.name}).indexOf(t)},UiManager.prototype.getPreviousComponent=function(t){var e=this._stack.length;return this._stack[(t+e-1)%e]},UiManager.prototype.addNavComponent=function(t){var e;_.contains(this._navStack,t)||(e=this.getComponent(t),this._navStack.push({component:e,name:t}))},UiManager.prototype.openHeader=function(){return this.openNav("StarzHeader")},UiManager.prototype.openNav=function(t,e){var i=this.getCurrentComponent();i&&(i=i.component).onBlur.apply(i),this.addNavComponent(t),(i=this.getCurrentComponent(!0).component).show(e),i.onFocus.apply(i)},UiManager.prototype.openComponentFromHeader=function(t){this.getComponent("StarzHeader").openSectionByName(t)},UiManager.prototype.refreshHeader=function(){this.getComponent("StarzHeader").reload()},UiManager.prototype.outHeader=function(){var t;this.closeNav(!0),(t=this.getCurrentComponent())&&(t=t.component).onFocus()},UiManager.prototype.closeNav=function(t){var e=this.getCurrentComponent(!0).component;if(!e)return!1;t?e.onBlur():e.hide(),(e=this.getCurrentComponent())&&((e=e.component).onFocus(),this._navStack.pop())},UiManager.prototype.setKeyPress=function(t){var e;return(0!==this.stackLength()||0!==this._navStack.length)&&(e=!1,0<this._navStack.length&&(e=!0),$("#Loading").hasClass("shown")?console.log("Loading"):this.getCurrentComponent(e).component.onKeyPress(t),!0)},VideoSession.prototype=Object.create(Observable.prototype),VideoSession.clearSessions=function(){if(t=Sagem.session.List())for(var t=t.split("|"),e=0;e<t.length;e++)Sagem.session.Delete(t[e])},VideoSession.getCurrentSessions=function(){var t=Sagem.session.List();return""===t?[]:t.split("|")},VideoSession.prototype.observePlayer=function(){var t=SagemEvents.getInstance();t.observe("SESSION_START",this.eventHandler.bind(this,{cb:this.onSessionStart})),t.observe("STREAM_START",this.eventHandler.bind(this,{})),t.observe("LIVE_START",this.eventHandler.bind(this,{cb:this.onLiveStart})),t.observe("LIVE_STREAM_START",this.eventHandler.bind(this,{cb:this.onLiveStart})),t.observe("SESSION_END",this.eventHandler.bind(this,{})),t.observe("ERROR",this.eventHandler.bind(this,{}))},VideoSession.prototype.onSessionStart=function(){this.started=!0,this.playerWindow=this.getWindow(),this.options.startPosition&&(this.setPosition(this.options.startPosition),this.options.startPosition=!1);var t=this.options.coords;t&&(this.setCoords(t.x,t.y,t.w,t.h),this.options.coords=!1)},VideoSession.prototype.onLiveStart=function(){var t=this.options.coords;this.started=!0,t&&(this.setCoords(t.x,t.y,t.w,t.h),this.options.coords=!1)},VideoSession.prototype.onStartVideo=function(){},VideoSession.prototype.eventHandler=function(t,e){t.hasOwnProperty("cb")&&t.cb.apply(this,[]),this.fire(e)},VideoSession.prototype.playUrl=function(t,e){$.extend(this.options,e);var i=Util.parseUri(t);i.file&&i.file.split&&i.file.split(".").pop(),!(this.started=!1)==("igmp"===i.protocol)?this.playIgmp(i,t):this.playMedia(t,e)},VideoSession.prototype.playHLS=function(t){console.info("Play HLS: ",t),this.type_player="STREAM",this.create(),this.sagem.session.Set(this.name,"PLAY_HLS",t)},VideoSession.prototype.playMedia=function(t,e){this.type_player="AVPLAYER",this.create(),this.processOptions(e),this.sagem.session.Set(this.name,"START_MODE","MEDIA",t)},VideoSession.prototype.playIgmp=function(t,e){this.type_player="LIVE",this.create(),this.sagem.session.Set(this.name,"PLAY_IP",t.host,t.port)},VideoSession.prototype.processOptions=function(t){var e,i,n;for(e in t)(i=this.posible_options[e])&&(n=t[e],Sagem.session.Set(this.name,"OPTION",i,n),delete t[e])},VideoSession.prototype.create=function(){this.deleteSession(),this.sagem.session.Create(this.type_player,this.name)},VideoSession.prototype.deleteSession=function(){this.playerWindow=!1,this.liveResolution=!1,this.current_sub_iso="und",this._subtitles=null,Sagem.session.Delete(this.name)},VideoSession.prototype.listSessions=function(){sagem.session.List()},VideoSession.prototype.getStatus=function(){return this.sagem.session.Get(this.name,"INFO").replace("0;","")},VideoSession.prototype.getVideoInfo=function(){return this.sagem.session.Get(this.name,"VIDEO","INFO")},VideoSession.prototype.getDuration=function(){var t=this.sagem.session.Get(this.name,"DURATION","time");return t=parseInt(t.replace("0;",""))},VideoSession.prototype.getCurrentRate=function(){var t=sagem.session.Get(this.name,"DOWNLOAD","LINE_RATE");return parseInt(t.replace(";",""))},VideoSession.prototype.getSpeed=function(){return this.sagem.session.Get(this.name,"SPEED").replace("0;","")},VideoSession.prototype.getPosition=function(){var t=this.sagem.session.Get(this.name,"POSITION","time");return parseInt(t.replace(";",""))},VideoSession.prototype.setSpeed=function(t){this.sagem.session.Set(this.name,"SPEED",t)},VideoSession.prototype.pause=function(){this.setSpeed(0)},VideoSession.prototype.resume=function(){this.setSpeed(1)},VideoSession.prototype.stop=function(){this.sagem.session.Set(this.name,"STOP")},VideoSession.prototype.setCoords=function(t,e,i,n){if(this.started){if("LIVE"!==this.type_player)return this.changeSize(t,e,i,n);this.setLivePosition(t,e),this.setLiveSize(i,n)}else this.options.coords={x:t,y:e,w:i,h:n}},VideoSession.prototype.changeSize=function(t,e,i,n){return t=this.getVwInPixels(t),e=this.getVhInPixels(e,!0),i=this.getVwInPixels(i),n=this.getVhInPixels(n,!0),this.sagem.session.Set(this.name,"WINDOW",t,e,i,n)},VideoSession.prototype.setLiveSize=function(t,e){this.sagem.session.Set(this.name,"SIZE",t=1<t?t/100:t,e=1<e?e/100:e)},VideoSession.prototype.setLivePosition=function(t,e){var i=this.getResolution();t=i.w/100*t,e=i.h/100*e,this.sagem.session.Set(this.name,"POS",t,e)},VideoSession.prototype.setSize=function(t,e){"LIVE"===this.type_player&&this.setLiveSize(t,e)},VideoSession.prototype.getResolution=function(t){return this.liveResolution&&!t||(t=(t=this.sagem.session.Get(this.name,"VIDEO_BOX")).split(":"),t={w:parseInt(t[2]),h:parseInt(t[3])},this.liveResolution=t),this.liveResolution},VideoSession.prototype.getSubtitlesLanguages=function(){var t=this.sagem.session.Get(this.name,"SUBTITLE","LIST"),t=this.getLanguages(t,!1);return t&&t.length&&t.push({id:!1,isocode:"und",language:"Subtitulo no disponible"}),t},VideoSession.prototype.getAudioLanguages=function(){var t=this.sagem.session.Get(this.name,"AUDIO","LIST");return this.getLanguages(t)},VideoSession.prototype.getLanguages=function(t){if(!t||"-1"==t)return[];for(var e,i=t.split(","),n=[],s=0;s<i.length;s++)"und"!=(e=i[s].split(":"))[2]&&n.unshift({id:e[0],isocode:e[2],language:Util.getIsoLanguage(e[2])});return n},VideoSession.prototype.getSubtitlesLanguagesB=function(){var t=this.sagem.session.Get(this.name,"SUBTITLE","LIST"),t=this.getLanguagesB(t,!1);return t&&t.length&&t.push({id:!1,isocode:"und",language:"Subtitulo no disponible"}),t},VideoSession.prototype.getAudioLanguagesB=function(){var t=this.sagem.session.Get(this.name,"AUDIO","LIST");return this.getLanguagesB(t,!0)},VideoSession.prototype.getLanguagesB=function(t,e){if(!t||"-1"==t)return[];var i,n=t.substring(0,2),s=(i=-1!=(t="0;"==n?t.replace(n,""):t).indexOf(";")?t.split(";"):[t],[]);if(e)for(a=0;a<i.length;a++)try{var o=(h=i[a].split(","))[1].split(":")[1],r=h[0].split(":")[1];s.unshift({id:o,isocode:r,language:Util.getIsoLanguage(r)})}catch(t){console.log("Error parsing audios: ",t)}else for(var a=0;a<i.length;a++)try{var h,p,c=(h=i[a].split(","))[0].split(":")[1];"und"!==(p=h[1].split(":")[1])&&s.unshift({id:c,isocode:p,language:Util.getIsoLanguage(p)})}catch(t){console.log("Error parsing subtitles: ",t)}return s},VideoSession.prototype.turnOnSubtitle=function(){this.sagem.session.Set(this.name,"SUBTITLE","ON")},VideoSession.prototype.turnOffSubtitle=function(){return this.sagem.session.Set(this.name,"SUBTITLE","OFF")},VideoSession.prototype.setSubtitleUrl=function(t){return this.sagem.session.Set(this.name,"SUBTITLE","URL",t)},VideoSession.prototype.setSubtitleIso=function(t){return this.current_sub_iso=t.isocode,"und"==t.isocode?this.turnOffSubtitle():this.sagem.session.Set(this.name,"SUBTITLE","LANG",t.isocode)},VideoSession.prototype._setSubtitleIso=function(t){for(var e,i=this._getSubtitlesList(),n=0;n<i.list.length;n++)i.list[n].isocode===t&&(i.current=n,e=i.list[n]);if(e)return this.setSubtitleIso(e),this._getCurrentSubtitle()},VideoSession.prototype.getSubtitleIso=function(){return this.current_sub_iso},VideoSession.prototype.setAudioIso=function(t){return this.sagem.session.Set(this.name,"AUDIO","LANG",t)},VideoSession.prototype.getAudioIso=function(){return this.sagem.session.Get(this.name,"AUDIO","LANG")},VideoSession.prototype.getAudioIsoB=function(){var t=this.sagem.session.Get(this.name,"AUDIO","CURRENT");return this.getLanguagesB(t,!0)},VideoSession.prototype._getAudioIsoB=function(){var t=this.sagem.session.Get(this.name,"AUDIO","CURRENT");return this.getLanguages(t,!0)},VideoSession.prototype.setPosition=function(t){this.sagem.session.Set(this.name,"POSITION",t,"time")},VideoSession.prototype.getWindow=function(){var t;return this.playerWindow||(t=this.sagem.session.Get(this.name,"WINDOW").replace("0;","").split(","),{x:parseInt(t[0]),y:parseInt(t[1]),w:parseInt(t[2]),h:parseInt(t[3])})},VideoSession.prototype.getVhInPixels=function(t){var e=this.playerWindow.h;return Math.round(e/100*t)},VideoSession.prototype.getVwInPixels=function(t){var e=this.playerWindow.w;return Math.round(e/100*t)},VideoSession.prototype.getTotalPackages=function(){return this.sagem.session.Get(this.name,"MPEGCOUNT")},VideoSession.prototype.getLostPackages=function(){return this.sagem.session.Get(this.name,"MPEGLOSS")},VideoSession.prototype.getPTS=function(){return this.sagem.session.Get(this.name,"POSITION","PTS")},VideoSession.prototype._getSubtitlesList=function(t){return this._subtitles&&!t||(this._subtitles={current:-1},t=this.sagem.session.Get(this.name,"SUBTITLE","LIST"),(t=this.getLanguages(t,!1))&&t.length&&(t.unshift({id:!1,isocode:"und",language:"Sin subtítulos"}),this._subtitles.current=0),this._subtitles.list=t),this._subtitles},VideoSession.prototype._getCurrentSubtitle=function(){var t=this._getSubtitlesList();return 0<=t.current&&{index:t.current,data:t.list[t.current]}},VideoSession.prototype._changeSubtitle=function(){var t=this._getSubtitlesList(),e=t.current+1,i=(e>=t.list.length&&(e=0),t.list[e]);return this.setSubtitleIso(i)&&(t.current=e),this._getCurrentSubtitle()},VideoSession.prototype._setSubtitle=function(t){for(var e=this._getSubtitlesList(),i=0,n=e.list.length;i<n;i++)e.list[i].isocode===t&&this.setSubtitleIso(e.list[i])&&(e.current=i)},View.prototype=Object.create(Observable.prototype),View.prototype.name="View",View.prototype.prepareData=function(t){this.data=t,this.id="View",this.template_data={},this.container_selector="#viewContainer"},View.prototype.create=function(){return this.create_promise=$.Deferred(),this.create_promise.resolve(),this.create_promise.then(this.renderView.bind(this))},View.prototype.renderView=function(){$(this.container_selector).html(Templates[this.name](this.template_data)),this.initialize()},View.prototype.launchError=function(t,e){this.fire("error",{code:t,message:e}),console.error("Error en la vista: "+this.name+", Código: "+t+":"+e)},View.prototype.getContainer=function(){return this.container||(this.container=$("#"+this.id)),this.container},View.prototype.destroy=function(){var t=$.Deferred();return this.getContainer().empty(),this.getContainer().remove(),delete this.container,this._listeners=!1,t.resolve(),t},View.prototype.initialize=function(){},View.prototype.actionHandler=function(t){console.error("Debes sobreescribir la función actionHandler de la vista "+this.name)},ViewManager.getInstance=function(){return ViewManager.instance||new ViewManager},ViewManager.getMainContainer=function(){return $(AppConfig.main_container_selector)},ViewManager.prototype.registerViews=function(t){t||this.launchError(6,"No hay vistar a registrar");for(var e=0;e<t.length;e++){if(void 0===t[e])return void this.launchError(6,"Error al registrar una vista");if(this.views[t[e].name])return void this.launchError(6,"Ya existe la vista "+t[e].name+" registrada.");this.views[t[e].name]=t[e]}},ViewManager.prototype.registerErrors=function(t){if(!Array.isArray(t))throw"errors debe ser un Array";this.errors=t},ViewManager.prototype.registerListeners=function(t){if(!Array.isArray(t))throw"listeners debe ser un Array";this.view_listeners=t},ViewManager.prototype.openView=function(t,e){this._loading=!0;var i,n=new t(e);n.observe("error",this.launchError.bind(this)),this._current_view&&(i=this._current_view.destroy()),$.when(i).then(function(){var t=n.create();return $.when(t).then(function(){console.log("Created :)"),this._loading=!1,this._current_view=n,this.addListeners(this._current_view)}.bind(this),function(t){console.error(t),this._loading=!1,this._current_view=!1,"object"==typeof t?this.launchError(t):this.launchError({code:666,message:"Error al cargar la vista"})}.bind(this))}.bind(this))},ViewManager.prototype.addListeners=function(t){if(Array.isArray(this.view_listeners))for(var e=this.view_listeners.length,i=0;i<e;i++)t.observe(this.view_listeners[i].event,this.view_listeners[i].listener)},ViewManager.prototype.isLoading=function(){return this._loading},ViewManager.prototype.getCurrentView=function(){return this._current_view},ViewManager.prototype.launchError=function(t){this._critical_error=t.critical;var e=$(this.error_container),t=Templates.error(t);e.html(t),this.showError(),this.mini_error=e.find(".error-container")},ViewManager.prototype.showError=function(){this._has_error=!0,window.setTimeout(function(){this.mini_error.removeClass("off")}.bind(this),0)},ViewManager.prototype.hideError=function(){this._critical_error&&window.close(),this._has_error=!1,this.mini_error.addClass("off")},ViewManager.prototype.getErrorMsg=function(t,e){return isNaN(parseInt(t))?this.getDefaultErrorMsg():e&&"string"==typeof e?e:this.getErrorMsgReg(t)||this.getDefaultErrorMsg()},ViewManager.prototype.hasError=function(){return this._has_error},ViewManager.prototype.hasCriticalError=function(){return this._critical_error},ViewManager.prototype.getErrorMsgReg=function(t){if(Array.isArray(this.errors))for(var e=this.errors.length,i=0;i<e;i++)if(void 0!==this.errors[i][t])return this.errors[i][t];return!1},ViewManager.prototype.getDefaultErrorMsg=function(){return"Error desconocido :("},ViewManager.prototype.errorActionHandler=function(t){switch(t){case AppActions.select:case AppActions.menu:case AppActions.back:this.hideError(),UiManager.getInstance().closeAll(),this.getCurrentView().onCloseError()}},ViewManager.prototype.actionHandler=function(t){var e=UiManager.getInstance();if(ViewManager.getInstance().hasError())return ViewManager.getInstance().errorActionHandler(t);e.setKeyPress(t)||ViewManager.getInstance().getCurrentView().neutralKeyPress(t)},ViewManager.prototype.openVod=function(){UiManager.getInstance().openLink()},ViewManager.prototype.openNetflix=function(){console.log("Open netflix from remoteControl"),UiManager.getInstance().openLink(AppConfig.netflix.link,{name:"remoteControl"})},function(n){n.fn.preloadImage=function(){var t,e,i;if(!(this.length<1))return 1<this.length?this.each(function(){n(this).preloadImage()}):(t=this.attr("data-image"),e=this,void(t&&((i=new Image).onload=function(){e.css("background-image","url("+t+")"),e.removeAttr("data-image"),delete i.onerror,delete i.onload,delete i.src,t=i=null},i.onerror=function(){delete i.onerror,delete i.onload,delete i.src,t=i=null},i.src=t)))}}(jQuery),String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"gi"),e)},window.Helpers=function(){var o={},e=[{longName:"domingo",shortName:"dom"},{longName:"lunes",shortName:"lun"},{longName:"martes",shortName:"mar"},{longName:"miércoles",shortName:"mié"},{longName:"jueves",shortName:"jue"},{longName:"viernes",shortName:"vie"},{longName:"sábado",shortName:"sáb"}],i=[{longName:"enero",shortName:"ene"},{longName:"febrero",shortName:"feb"},{longName:"marzo",shortName:"mar"},{longName:"abril",shortName:"abr"},{longName:"mayo",shortName:"may"},{longName:"junio",shortName:"jun"},{longName:"julio",shortName:"jul"},{longName:"agosto",shortName:"ago"},{longName:"septiembre",shortName:"sep"},{longName:"octubre",shortName:"oct"},{longName:"noviembre",shortName:"nov"},{longName:"diciembre",shortName:"dic"}];return o.shuffle=function(t){for(var e,i=[],n=t.length;n;)e=Math.floor(Math.random()*n--),i.push(t.splice(e,1)[0]);return i},o.getRandomIntInclusive=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t},o.inArray=function(t,e){for(var i=e.length,n=0;n<i;n++)if(e[n]==t)return!0;return!1},o.preloadImages=function(t){o.preloadImages.list||(o.preloadImages.list=[]);for(var e=o.preloadImages.list,i=0;i<t.length;i++){var n=new Image;n.onload=function(){var t=e.indexOf(this);-1!==t&&e.splice(t,1)},e.push(n),n.src=t[i]}},o.pixelsToVUnits=function(t,e){var i;return e?(i=720,0):i=1280,parseFloat(Math.round(100*(t/i*100))/100).toFixed(2)},o.getMacAddressFromFile=function(){return this.getFile("/flash/mac_address")},o.getMacAddress=function(){var t,e="/flash/mac_address";return this._mac_address&&this.isValidMacAddress(this._mac_address)?Promise.resolve(this._mac_address):(t=this.getFile(e))&&this.isValidMacAddress(t)?(this._mac_address=t,console.log("MAC from file: "+this._mac_address),Promise.resolve(this._mac_address)):!this._mac_address&&(t=Sagem.Get("NETWORK","MAC","br0@vod")+"")&&this.isValidMacAddress(t)?(t=t.toLowerCase(),this._mac_address=t,this.setFile(e,this._mac_address),console.log("MAC from sagem object: "+this._mac_address),Promise.resolve(this._mac_address)):(new WifiSocket).getConfig("eth0").then(function(t){t=t.hwaddr;return t&&(t=t.toLowerCase()).length&&!(t.length<12)&&(t=t.substring(0,2)+":"+t.substring(2,4)+":"+t.substring(4,6)+":"+t.substring(6,8)+":"+t.substring(8,10)+":"+t.substring(10,12),this._mac_address=t,this.isValidMacAddress(this._mac_address))?(this.setFile(e,this._mac_address),console.log("MAC from socket: "+this._mac_address),Promise.resolve(this._mac_address)):Promise.reject()}.bind(this),function(){return Promise.reject()}.bind(this))},o.isValidMacAddress=function(t){return!(!t||!t.toUpperCase)&&(t=t.toUpperCase(),/^([0-9A-F]{2}[:-]){5}([0-9A-F]{2})$/.test(t))},o.getTimezone=function(){return Sagem.Get("TIME","TIME_OFFSET")/3600},o.getFile=function(t){return Sagem.Get("FS","FILE",t)},o.setFile=function(t,e){return Sagem.Set("FS","FILE",t,e)},o.rmDir=function(t){return Sagem.Set("FS","RM",t)},o.saveSetting=function(t,e){var i=STB.getInstance(),n=i.getFile(AppConfig.local_settings_file);try{n=JSON.parse(n)}catch(t){console.error(t),n={}}AppConfig.local_settings[t]=e,n[t]=e,n=JSON.stringify(n),i.setFile(AppConfig.local_settings_file,n)},o.getSetting=function(t){return AppConfig.local_settings[t]},o.getIpAddres=function(){return Sagem.Get("NETWORK","IP")},o.getUrlParameter=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},o.formatMonthName=function(t,e){t=t.getMonth();return e?this.longMothFormat(t):this.shortMonthFormat(t)},o.concatDayMonth=function(t,e){e=e||{};var i=t.getDate(),t=this.formatMonthName(t,e.monthLongFormat);return i+(e.separator||" ")+t},o.dayFormatted=function(t){var t=new Date(t),e=t.getDate(),i=this.shortMonthFormat(t.getMonth());return this.longDayFormat(t.getDay())+" "+e+" "+i},o.parseUri=function t(e){for(var n=t.options,i=n.parser[n.strictMode?"strict":"loose"].exec(e),s={},o=14;o--;)s[n.key[o]]=i[o]||"";return s[n.q.name]={},s[n.key[12]].replace(n.q.parser,function(t,e,i){e&&(s[n.q.name][e]=i)}),s},o.parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},o.encryptByDES=function(t,e){e=CryptoJS.enc.Utf8.parse(e);return CryptoJS.DES.encrypt(t,e,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7}).toString()},o.decryptByDES=function(t,e){e=CryptoJS.enc.Utf8.parse(e);return CryptoJS.DES.decrypt({ciphertext:CryptoJS.enc.Base64.parse(t)},e,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7}).toString(CryptoJS.enc.Utf8)},o.doEncryptMac=function(t,e){var t=t.replace(/:/g,""),i={mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7};return this.encryptByDES(t,e,i)},o.encryptMac=function(t){var e=AppConfig.webServices.key;return this.doEncryptMac(t,e)},o.encryptNip=function(t){t=t||"-1";var e=AppConfig.tp_backend.keyNip;return this.encryptByDES(t,e)},o.getHrsText=function(t,e,i){return(t=t<10?"0"+t:t)+":"+(e=e<10?"0"+e:e)+(i?"":" hrs")},o.getHrsFormat=function(t){s=Math.round(t/1e3);var t=parseInt(s/3600)%24,e=parseInt(s/60)%60;return this.getHrsText(t,e)},o.getTimeFromTs=function(t){t=new Date(t);return this.getHrsText(t.getHours(),t.getMinutes())},o.shortDayFormat=function(t){return e[t].shortName},o.longDayFormat=function(t){return e[t].longName},o.shortMonthFormat=function(t){return i[t].shortName},o.capitalizeFirstLetter=function(t){return t[0].toUpperCase()+t.slice(1)},o.daysDiff=function(t,e){return Math.round((t-e)/864e5)},o.versionCompare=function(t,e,i){var n=i&&i.lexicographical,i=i&&i.zeroExtend,s=t.split("."),o=e.split(".");function r(t){return(n?/^\d+[A-Za-z]*$/:/^\d+$/).test(t)}if(!s.every(r)||!o.every(r))return NaN;if(i){for(;s.length<o.length;)s.push("0");for(;o.length<s.length;)o.push("0")}n||(s=s.map(Number),o=o.map(Number));for(var a=0;a<s.length;++a){if(o.length==a)return 1;if(s[a]!=o[a])return s[a]>o[a]?1:-1}return s.length!=o.length?-1:0},o.capitalizeFirstLetter=function(t){return t[0].toUpperCase()+t.slice(1)},o.replaceAll=function(t,e,i){if(!t)return null;for(;-1!=t.toString().indexOf(e);)t=t.toString().replace(e,i);return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("á","a")).replace("é","e")).replace("í","i")).replace("ó","o")).replace("ú","u")).replace("Á","A")).replace("É","E")).replace("Í","I")).replace("Ó","O")).replace("Ú","U")},o.getDeviceFriendlyName=function(){return Sagem.Get("STB","DIAL_SERVER","FRIENDLY_NAME")},o.getDeviceName=function(){var t=this.getDeviceFriendlyName().match(/[\d]+/g);return!!t&&"M"+t[0]},o.is4K=function(){return"M384"==SagemHelpers.getUserAgent()},o.pick=function(e,t){var i={};return t.map(function(t){t in e&&(i[t]=e[t])}),i},o.pickObjectsProperties=function(t,e){return t.map(function(t){return this.pick(t,e)}.bind(this))},o.isRunningNetflix=function(){return"running"==Sagem.Get("NETFLIX","STATUS").toLowerCase()},o.stopNetflix=function(){return Sagem.Set("NETFLIX","STOP")},o.getInterfaces=function(){for(var t,e,i=[],n=parseInt(Sagem.Get("NETWORK","INTERFACE","INDEX")),s=0;s<=n;s++)e=Sagem.Get("NETWORK","INTERFACE","TYPE",s),t=Sagem.Get("NETWORK","INTERFACE","NAME",s),"-1"!==e&&-1!==e&&"-1"!==t&&-1!==t&&i.push({index:s,type:e,name:t});return i},o.getWifiIndexes=function(){for(var t,e,i=this.getInterfaces(),n=[],s=0,o=i.length;s<o;s++)(t=i[s].name.toLowerCase()).startsWith("wl")&&(e=Sagem.Get("NETWORK","WIRELESS","AP","CONFIG",i[s].index),n.push({index:i[s].index,name:t,settings:JSON.parse(e)}));return n},o.getInterfaceIndex=function(t){for(var e=this.getInterfaces(),i=0,n=e.length;i<n;i++)if(e[i].name.toLowerCase()===t)return e[i].index;return-1},o.getWifiInterfaceIndex=function(){return this.getInterfaceIndex("wl0")},o.getEthernetInterfaceIndex=function(){return this.getInterfaceIndex("eth0")},o.isEmptyObject=function(t){return $.isEmptyObject(t)},o.moveArrayElement=function(t,e,i){if(i>=t.length)for(var n=i-t.length+1;n--;)t.push(void 0);return t.splice(i,0,t.splice(e,1)[0]),t},o.getNextNDays=function(t){var e=new Date;return e.setDate(e.getDate()+t),e.setMilliseconds(0),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e},o.getTomorrow=function(){return this.getNextNDays(1)},o}(),Handlebars.registerHelper("call",function(t,e){return _.isFunction(t[e])?t[e].call(t):""}),Handlebars.registerHelper("times",function(t,e){for(var i="",n=0;n<t;++n)i+=e.fn(n);return i}),Handlebars.registerHelper("ifEquals",function(t,e,i){return t==e?i.fn(this):i.inverse(this)});