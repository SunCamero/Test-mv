function AddCreditCard(){UiComponent.call(this)}function CardPayment(t){this.hidden_class="off",this.active_class="active",this.data={},UiComponent.call(this,t)}function ConfirmCardScreen(t){UiComponent.call(this)}function CreditPayment(t){this.hidden_class="off",this.active_class="active",this.data={},UiComponent.call(this,t)}function Error(){UiComponent.call(this)}function ExitApp(){this.id="Exit",UiComponent.call(this)}function KeyboardComponent(t){this.id="KeyboardComponent",this.hidden_class="off",this.limit=16,this.section="qwerty",this.keyword="",this.originalText="",this.data={},this.config={title:"Ingresa tu búsqueda",minimumChars:1,maximumChars:16,enableSpecials:!0,showRecentSearch:!1,validateCallback:void 0,msgErrorCallback:"",msgErrorMaximun:"Solo se permiten 16 dígitos",msgErrorMinimun:"Se requiere mínimo 16 dígitos",initialValue:"",counterMode:"decrement",changeCounterColor:!1,isPassword:!1,fontSizeKeys:"font-42",startWithCaps:!0,showAutoComplete:!1,autoCompleteData:[]},this.config=$.extend(this.config,t),this.data.showRecentSearch=this.config.showRecentSearch,this.data=$.extend(this.data,this.DataKeyboard),this.data.id=this.id,this.data.counterInitialValue="decrement"!==this.config.counterMode?0:this.config.maximumChars,this.data.config=this.config,UiComponent.call(this,this.data)}function LandingPage(){this.id="LandingPage",UiComponent.call(this)}function NipComponent(t){UiComponent.call(this)}function NumericKeyboard(t){KeyboardComponent.call(this,t),this.id="NumericKeyboard"}function OptionsList(){UiComponent.call(this)}function OptionsReciveCode(t){this.hidden_class="off",this.active_class="active",this.data={},UiComponent.call(this,t)}function OrderSummary(t){UiComponent.call(this)}function Purchase(t){UiComponent.call(this)}function VideoIntro(){this.id="VideoIntro",this.sessionName="BackgroundPlayer",UiComponent.call(this)}AddCreditCard.prototype=Object.create(UiComponent.prototype),AddCreditCard.prototype.name="AddCreditCard",AddCreditCard.prototype.show=function(t){this.edit=t.edit,this.payment=t.payment,this.summary=t.summary,this.data.textButton=this.edit?"Editar tarjeta":"Guardar y pagar",this.data.listBtn=[{name:this.data.textButton,type:"Add"}],this.edit&&(e=("AMERICAN EXPRESS"==t.card._data.savedCard.nCvv?"***********":"************")+(e=t.card._data.savedCard.ending).substring(1,5),this.idCard=t.card._data.savedCard.id,this.data.listBtn.push({name:"Eliminar",type:"Delete"}),this.activeButton=!0,this.flagCredit=!0);var e=[{title:"NO. DE TARJETA",class:"number-card",content:this.edit?e:""},{title:"",class:"month",content:"MES"},{title:"",class:"year",content:"AÑO"}];this.parentMain=t.parent,this.data.buttons=e,this.getContainer(!0),this.render(),this.initComponents()},AddCreditCard.prototype.render=function(t){var e=ViewManager.getMainContainer(),o=UiComponent.prototype.render.call(this);$("#"+this.name).remove(),e.append(o)},AddCreditCard.prototype.initComponents=function(){this.listBtn=new ListComponent("btn-list",{selector:".item",direction:"vertical"},this.data.listBtn),this.listCard=new ListComponent("container-list",{selector:".item"},this.data.buttons),this.listCard.setFocusIndex(0),this.currentSection="list"},AddCreditCard.prototype.onFocusMenu=function(t,e){},AddCreditCard.prototype.hide=function(t){var e=this.getContainer(!0),o=this;e.addClass("hidden"),setTimeout(function(){t||(o.getContainer(),o.destroy())},200)},AddCreditCard.prototype.onFocus=function(t){this.getContainer().removeClass("hidden")},AddCreditCard.prototype.onBlur=function(){},AddCreditCard.prototype.validRightAction=function(t){var e=this.listCard;switch(t){case 0:break;case 1:e.setFocusIndex(2);break;case 2:case 3:break;case 4:e.setFocusIndex(0);break;case 5:e.setFocusIndex(3)}},AddCreditCard.prototype.validLeftAction=function(t){var e=this.listCard;switch(t){case 0:case 1:e.setFocusIndex(4);break;case 2:e.setFocusIndex(1);break;case 3:e.setFocusIndex(5)}},AddCreditCard.prototype.close=function(){this.flagMonths=null,this.activeButton=null,this.flagCredit=null,this.flagYear=null,UiManager.getInstance().closeComponent()},AddCreditCard.prototype.unlock=function(){this.block=!1},AddCreditCard.prototype.onKeyPress=function(t){switch(this.currentSection){case"list":this.onMainMenuKeyPress(t);break;case"keyboard":this.onKeyPressKeyBoard(t);break;case"numeric":this.keyboardSearch.actionHandler(t);break;case"submit":this.onKeyPressSubmit(t);break;case"exit":this.onKeyPressExit(t)}},AddCreditCard.prototype.onMainMenuKeyPress=function(t){var e=this.listCard,o=(UiManager.getInstance(),e.getFocusIndex());switch(t){case AppActions.moveRight:this.validRightAction(o);break;case AppActions.moveLeft:this.validLeftAction(o);break;case AppActions.moveDown:!this.activeButton||1!=o&&2!=o?e.nextItem():(e.offFocus(),this.flagMonths&&this.flagYear?this.listBtn.setFocusIndex(0):this.listBtn.setFocusIndex(1),this.currentSection="submit");break;case AppActions.moveUp:4==o||0==o?($("#"+this.name).find(".exit").addClass("active"),e.offFocus(),this.currentSection="exit"):3==o?e.setFocusIndex(1):2==o?e.setFocusIndex(0):e.previousItem();break;case AppActions.select:this.onSelected(o);break;case AppActions.back:case AppActions.menu:this.close()}},AddCreditCard.prototype.onKeyPressKeyBoard=function(t){this.keyboard.onKeyPress(t)},AddCreditCard.prototype.onKeyPressSubmit=function(t){var e=this.listBtn;switch(t){case AppActions.moveUp:0==e.getFocusIndex()?(this.listCard.setFocusIndex(),e.setFocusIndex(),this.currentSection="list"):this.flagMonths&&this.flagYear&&this.flagCredit?e.previousItem():(this.listCard.setFocusIndex(),e.setFocusIndex(),this.currentSection="list");break;case AppActions.moveDown:e.nextItem();break;case AppActions.select:var o=e.getFocusItem().data("data");this.setLoading(),this.registrerOrEdit(o.type);break;case AppActions.back:case AppActions.menu:this.close()}},AddCreditCard.prototype.getAliasProvider=function(t){var e;if(t)return 3==t[0]&&15==t.length&&(e="AMEX"),4==t[0]&&16==t.length&&(e="VISA"),e=5==t[0]&&16==t.length?"MASTERCARD":e},AddCreditCard.prototype.registrerOrEdit=function(t){var a=this,e=$("#"+this.name).find(".month").find(".content").html(),o=(o=$("#"+this.name).find(".year").find(".content").html()).substring(2,4),e={expMonth:Util.encryptByAES(e,AppConfig.tp_backend.key).toString(),expYear:Util.encryptByAES(o,AppConfig.tp_backend.key).toString()};("Delete"==t?(o={cardId:this.idCard},Totalplay.getInstance().deleteCard(o)):(this.edit?(e.cardId=Util.encryptByAES(this.idCard+"",AppConfig.tp_backend.key).toString(),e.isRecurrent=!1):(e.cardNumber=Util.encryptByAES(this.number,AppConfig.tp_backend.key).toString(),e.aliasProvider=Util.encryptByAES(this.getAliasProvider(this.number),AppConfig.tp_backend.key).toString()),this.edit?Totalplay.getInstance().editCard(e):Totalplay.getInstance().registerCard(e))).then(function(t){console.log("agregado");var e=ShoppingCart.getInstance().getProductId();Totalplay.getInstance().getAllPaymentMethods(e,a.summary.id).then(function(t){console.log("actualiza"),UiManager.removeLoading();for(var e,o,s=[],i=this.number.substring(this.number.length-5),n=0;n<t.arrCardsPayments.length;n++)t.arrCardsPayments[n].getEnding()==i&&s.push(t.arrCardsPayments[n]);0<s.length?UiManager.getInstance().openComponent("OptionsReciveCode",{paymentSelected:s[0],summary:a.summary},!0,!0):(e=UiManager.getInstance(),(o={}).onConfirm=this.onError,UiManager.removeLoading(),e.openComponent("Error",o))}.bind(this),function(t){var e=UiManager.getInstance();t.onConfirm=me.onError,UiManager.removeLoading(),e.openComponent("Error",t)})}.bind(this),function(t){t.onConfirm=a.onError,a.removeLoading(),UiManager.getInstance().openComponent("Error",t)})},AddCreditCard.prototype.onError=function(){UiManager.getInstance().closeComponent()},AddCreditCard.prototype.onKeyPressExit=function(t){switch(t){case AppActions.moveDown:$("#"+this.name).find(".exit").removeClass("active"),this.listCard.setFocusIndex(),this.currentSection="list";break;case AppActions.select:case AppActions.back:case AppActions.menu:this.close()}},AddCreditCard.prototype.onSelected=function(t){switch(t){case 0:this.flagCredit=!1,this.createKeyboard(),this.keyboardSearch.show(),this.currentSection="numeric";break;case 1:this.parent="months",UiManager.getInstance().openComponent("OptionsList",{list:this.getMonths(),onSelected:this.elementSelected.bind(this),title:"Mes de vencimiento de la tarjeta",parent:this.parent},!0,!1,!0);break;case 2:this.parent="years",UiManager.getInstance().openComponent("OptionsList",{list:this.getYears(),onSelected:this.elementSelected.bind(this),title:"Año de vencimiento de la tarjeta",parent:this.parent},!0,!1,!0)}},AddCreditCard.prototype.validateButton=function(){this.activeButton=!1,this.flagMonths&&this.flagYear&&this.flagCredit&&(this.activeButton=!0,this.listBtn.items.removeClass("onBlur"))},AddCreditCard.prototype.elementSelected=function(t){var e=$("#"+this.name);switch(this.parent){case"months":this.flagMonths=!0,e.find(".month").find(".content").html(t),this.validateButton();break;case"years":this.flagYear=!0,e.find(".year").find(".content").html(t),this.validateButton()}},AddCreditCard.prototype.onClose=function(){this.keyboardSearch.stopEventObserving("hide"),this.currentSection="list",this.number=this.keyboardSearch.getText(),this.getNumberCreditcard(this.number)},AddCreditCard.prototype.createKeyboard=function(){this.opts_keyboard={title:"Ingresa los 16 dígitos de tu tarjeta de crédito o débito",counterMode:"decrement",maximumChars:16,minimumChars:16,msgErrorMinimun:"Debes ingresar los 16 dígitos de la tarjeta",changeCounterColor:!0,fontSizeKeys:"font-44",type:"credit"},this.keyboardSearch=new NumericKeyboard(this.opts_keyboard),this.keyboardSearch.observe("hide",this.onClose.bind(this))},AddCreditCard.prototype.getNumberCreditcard=function(t){if(""!=t){for(var e=t,o="",s=0;s<e.length-4;s++)o+="*";dataNumber=t.replace(e,o);var t=e.slice(-4),t=dataNumber+t,t=this.addSpace(t,4,""),i=this.listCard.getFocusData().class,n=(this.getContainer(),this.listCard.getFocusItem());this.flagCredit=!0,"number-card"===i&&n.find(".content").html(t),this.validateButton()}},AddCreditCard.prototype.addSpace=function(t,e,o){return o=o||"\r\n",!((e=parseInt(e,10)||76)<1)&&t.match(new RegExp(".{0,"+e+"}","g")).join(o)},AddCreditCard.prototype.getMonths=function(){return[{month:"01"},{month:"02"},{month:"03"},{month:"04"},{month:"05"},{month:"06"},{month:"07"},{month:"08"},{month:"09"},{month:"10"},{month:"11"},{month:"12"}]},AddCreditCard.prototype.getYears=function(){return[{year:"2023"},{year:"2024"},{year:"2025"},{year:"2026"},{year:"2027"},{year:"2028"},{year:"2029"},{year:"2030"},{year:"2031"},{year:"2032"},{year:"2033"}]},CardPayment.prototype=Object.create(UiComponent.prototype),CardPayment.prototype.name="CardPayment",CardPayment.getInstance=function(t){return CardPayment.instance||new CardPayment(t)},CardPayment.prototype.initialize=function(){},CardPayment.prototype.render=function(t){return t?UiComponent.prototype.render.call(this):""},CardPayment.prototype.show=function(t){this.summary=t.summary,this.data.phone=Util.splitPhone(AppConfig.profile.callCenterInfo),this.initComponent(t);t=this.render(!0);$("#mainContainer").append(t),this.initList(),setTimeout(function(){$("#CardPayment").addClass("shown")},100)},CardPayment.prototype.initComponent=function(t){this.data.arrCardsPayments=t.items,this.current_section="recover"},CardPayment.prototype.initList=function(t){this.optionsList=new ScrollListComponent("cardsOptions",{maxFocusIndex:0},this.data.arrCardsPayments),this.optionsList.setFocusIndex(0),this.buttonBack=this.getContainer().find(".back-arrow"),this.current_section="recover"},CardPayment.prototype.hide=function(t){var e,o=this.getContainer();o.addClass(this.hidden_class),t||((e=this).fire("hide"),(o=this.getContainer()).removeClass("shown"),this.data.arrCardsPayments=null,this.optionsList=null,setTimeout(function(){e.destroy(),o.remove()},100))},CardPayment.prototype.onFocus=function(){this.getContainer(!0).removeClass("off hidden"),this.current_section="recover"},CardPayment.prototype.onBlur=function(){},CardPayment.prototype.onKeyPress=function(t){switch(t!==AppActions.menu&&t!==AppActions.back||UiManager.getInstance().closeComponent(),this.current_section){case"recover":this.actionHandlerRecoverNip(t);break;case"back":this.actionHandlerBtnBack(t)}},CardPayment.prototype.actionHandlerBtnBack=function(t){switch(t){case AppActions.select:UiManager.getInstance().closeComponent();break;case AppActions.moveDown:this.buttonBack.removeClass("active"),this.optionsList.setFocusIndex(),this.current_section="recover"}},CardPayment.prototype.actionHandlerRecoverNip=function(t){switch(t){case AppActions.moveUp:this.optionsList.offFocus(),this.buttonBack.addClass("active"),this.current_section="back";break;case AppActions.select:var e=this.optionsList.getFocusData();"add"==e.getType()?UiManager.getInstance().openComponent("AddCreditCard",{payment:e,summary:this.summary},!0,!0):UiManager.getInstance().openComponent("OptionsReciveCode",{paymentSelected:e,summary:this.summary},!0,!0);break;case AppActions.moveLeft:this.optionsList.previousItem();break;case AppActions.moveRight:this.optionsList.nextItem()}},CardPayment.prototype.onError=function(t){t.code;UiManager.getInstance().openComponent("Error",t)},ConfirmCardScreen.prototype=Object.create(UiComponent.prototype),ConfirmCardScreen.prototype.name="ConfirmCardScreen",ConfirmCardScreen.prototype.show=function(t){var e=this.name;this.data.paymentSelected=t.paymentSelected,this.summary=t.summary,this.nip_index=0,this.nip=[],this.setNipFocus(),this.initialize(),this.render(),this.getContainer(!0),this.current_section="cvv",setTimeout(function(){$("#"+e).addClass("shown")},100)},ConfirmCardScreen.prototype.render=function(){var t=UiComponent.prototype.render.call(this),e=ViewManager.getMainContainer();$("#"+this.name).remove(),e.append(t)},ConfirmCardScreen.prototype.initialize=function(){},ConfirmCardScreen.prototype.onFocus=function(){3==this.data.paymentSelected.getCvvLength()?$(".cvv-image").css("background-image",'url("assets/img/bancos/Mockup.png")'):($(".cvv-circule").css("top","23.9vw"),$(".cvv-container").css("left","58.9vw"),$(".cvv-container").css("width","22.38vw"),$(".cvv-image").css("background-image",'url("assets/img/bancos/Mockup-front.png")'))},ConfirmCardScreen.prototype.onBlur=function(){},ConfirmCardScreen.prototype.setNipFocus=function(){this.getContainer(!0);var t=$("#"+this.name+"_DigitsContainer").find(".cvv-digit"),e=4==this.data.paymentSelected.getCvvLength()?(this.lengthCvv=4,this.nip_index):(this.lengthCvv=3,this.nip_index-1);t.eq(e).addClass("active")},ConfirmCardScreen.prototype.onNipKeyPress=function(t){switch(t){case AppActions.qaControl:case AppActions.qaControl1:case AppActions.qaControl2:case AppActions.qaControl3:case AppActions.qaControl4:case AppActions.qaControl5:case AppActions.qaControl6:case AppActions.qaControl7:case AppActions.qaControl8:case AppActions.qaControl9:case AppActions.qaControl0:this.processNumber(t);break;case AppActions.moveDown:var e=this.getContainer();e.find(".button").addClass("active"),e.find(".cvv-digit").removeClass("active"),this.current_section="button";break;case AppActions.select:break;case AppActions.backspace:this.deleteNipElement()}},ConfirmCardScreen.prototype.processNumber=function(t){parseInt(t);var e=this.getContainer();e.find(".cvv-digit").eq(this.nip.length).html("*"),e.find(".cvv-digit").removeClass("active"),e.find(".cvv-digit").eq(this.nip.length+1).addClass("active"),this.nip_index++,this.nip.push(t);e=this.nip.join().replace(/,/g,"");e.length===this.lengthCvv&&this.makeBuyCard(e)},ConfirmCardScreen.prototype.makeBuyCard=function(t){UiManager.setLoading();var e,o,s=this;"card"==this.data.paymentSelected.getType()&&(o="unique"==(e=this.data.paymentSelected.getPayments()[0])._data.type?0:e._data.nPayments,o={idSummary:Util.encryptByAES(this.summary.id,AppConfig.tp_backend.key).toString(),idCard:Util.encryptByAES(this.data.paymentSelected.getIdCard()+"",AppConfig.tp_backend.key).toString(),ccv:Util.encryptByAES(t+"",AppConfig.tp_backend.key).toString(),msi:o,creditTp:0,creditTpM:""},this.amount=e.getAmountInt()),Totalplay.getInstance().makeBuy(o).then(function(t){0==t.idBuy?("AddCreditCard"==UiManager.getInstance().getOtherFocusComponent().name&&UiManager.getInstance().closeComponent(),UiManager.getInstance().closeComponent(),UiManager.getInstance().closeComponent(),this.onErrorBuy(t)):(this.order=t,this.removeLoading(),this.purchaseConfirm())}.bind(this),function(t){var e=UiManager.getInstance();t.onConfirm=s.onError,UiManager.removeLoading(),e.openComponent("Error",t)})},ConfirmCardScreen.prototype.makeFakeBuy=function(){return new Promise(function(t,e){setTimeout(function(){t()},2e3)})},ConfirmCardScreen.prototype.sendBuyRegister=function(t){var e=ShoppingCart.getInstance(),o={},s=Totalplay.getInstance();ShoppingCart.getInstance().getProductId();return o.showAlias=e.getShowsData("alias"),o.specialEventAlias=e.getCelebration().alias,o.zoneAlias=e.getZonesData("alias"),o.datePurchase=Date.now(),o.totalPeople=e.getTicketsData("noAttendees"),o.couponPrice=e.getCouponsData("price"),o.couponValue=e.getCouponsData("price"),o.monthlyPayment=this.amount,o.showTimestamp=e.getShowsTimesData("timestamp"),o.customerName=AppConfig.profile.name,o.purchaseId=this.order.idBuy,o.orderId=this.order.idOrder,s.registerPurchase(o)},ConfirmCardScreen.prototype.purchaseConfirm=function(){var e=UiManager.getInstance(),o=this;this.sendBuyRegister().then(function(t){e.openComponent("Purchase",{qrImage:t.url},!0,!0),UiManager.removeLoading()},function(t){var e=UiManager.getInstance();console.error("Some error",t),t.onConfirm=o.onError,UiManager.removeLoading(),e.openComponent("Error",t)})},ConfirmCardScreen.prototype.onKeyPress=function(t){switch(t){case AppActions.back:case AppActions.menu:UiManager.getInstance().closeComponent()}switch(this.current_section){case"cvv":this.onNipKeyPress(t);break;case"button":this.onButton(t)}},ConfirmCardScreen.prototype.onButton=function(t){switch(t){case AppActions.moveUp:var e=this.getContainer();e.find(".button").removeClass("active"),e.find(".cvv-digit").eq(this.nip.length).addClass("active"),this.current_section="cvv";break;case AppActions.select:UiManager.getInstance().closeComponent()}},ConfirmCardScreen.prototype.deleteNipElement=function(){var t;0!=this.nip.length&&((t=$("#"+this.name).find(".cvv-digit")).eq(this.nip_index-1).html(""),this.nip_index--,t.removeClass("active"),t.eq(this.nip_index).addClass("active"),this.nip.pop(),0===this.nip.length)&&(this.nip=[])},ConfirmCardScreen.prototype.deleteNipArray=function(){$("#"+this.name).find(".cvv-digit").html(""),this.nip=[],this.nip_index=0},ConfirmCardScreen.prototype.hide=function(t){$("#"+this.name).removeClass("shown"),t||(this.nip=null,this.nip_index=null,this.current_section=null,setTimeout(function(){this.getContainer(),this.destroy()}.bind(this),200))},ConfirmCardScreen.prototype.onError=function(){UiManager.getInstance().closeComponent()},ConfirmCardScreen.prototype.showError=function(t){var e=UiManager.getInstance();console.error("Some error",t),t.onConfirm=this.onError,UiManager.removeLoading(),e.openComponent("Error",t)},ConfirmCardScreen.prototype.onErrorBuy=function(t){data=t.idBuy?{title:"Por el momento no podemos procesar tu compra. ¡Inténtalo más tarde!",message:"",critical:!1}:{title:"Ha ocurrido un error. ¡Inténtalo más tarde!",code:t.code||500,message:"",critical:!1},this.showError(data)},CreditPayment.prototype=Object.create(UiComponent.prototype),CreditPayment.prototype.name="CreditPayment",CreditPayment.getInstance=function(t){return CreditPayment.instance||new CreditPayment(t)},CreditPayment.prototype.initialize=function(){},CreditPayment.prototype.render=function(t){return t?UiComponent.prototype.render.call(this):""},CreditPayment.prototype.show=function(t){this.summary=t.summary,this.data.phone=Util.splitPhone(AppConfig.profile.callCenterInfo),this.initComponent(t.items);t=this.render(!0);$("#mainContainer").append(t),this.initList(),setTimeout(function(){$("#CreditPayment").addClass("shown")},100)},CreditPayment.prototype.initComponent=function(t){this.data.paymentsList=t,this.current_section="recover"},CreditPayment.prototype.initList=function(t){this.optionsList=new ScrollListComponent("creditOptions",{maxFocusIndex:0},this.data.paymentsList),this.optionsList.setFocusIndex(0),this.buttonBack=this.getContainer().find(".back-arrow"),this.current_section="recover"},CreditPayment.prototype.hide=function(t){var e,o=this.getContainer();o.addClass(this.hidden_class),t||((e=this).fire("hide"),(o=this.getContainer()).removeClass("shown"),this.data.paymentsList=null,this.optionsList=null,setTimeout(function(){e.destroy(),o.remove()},100))},CreditPayment.prototype.onFocus=function(){this.getContainer(!0).removeClass("off hidden"),this.current_section="recover"},CreditPayment.prototype.onBlur=function(){},CreditPayment.prototype.onKeyPress=function(t){switch(t!==AppActions.menu&&t!==AppActions.back||UiManager.getInstance().closeComponent(),this.current_section){case"recover":this.actionHandlerRecoverNip(t);break;case"back":this.actionHandlerBtnBack(t)}},CreditPayment.prototype.actionHandlerBtnBack=function(t){switch(t){case AppActions.select:UiManager.getInstance().closeComponent();break;case AppActions.moveDown:this.buttonBack.removeClass("active"),this.optionsList.setFocusIndex(),this.current_section="recover"}},CreditPayment.prototype.actionHandlerRecoverNip=function(t){switch(t){case AppActions.moveUp:this.optionsList.offFocus(),this.buttonBack.addClass("active"),this.current_section="back";break;case AppActions.select:var e=this.optionsList.getFocusData();UiManager.getInstance().openComponent("OptionsReciveCode",{paymentSelected:e,summary:this.summary},!0,!0);break;case AppActions.moveLeft:this.optionsList.previousItem();break;case AppActions.moveRight:this.optionsList.nextItem()}},CreditPayment.prototype.onError=function(t){t.code;UiManager.getInstance().openComponent("Error",t)},Error.prototype=Object.create(UiComponent.prototype),Error.prototype.name="Error",Error.prototype.show=function(t){this.data.title=t.title||"Ha ocurrido un error. ¡Inténtalo más tarde!",this.data.message=t.message,this.data.code=t.code,this.onConfirm=t.onConfirm,this.data.critical=t.critical,this.render(),this.current_section="button"},Error.prototype.render=function(){var t=UiComponent.prototype.render.call(this),e=ViewManager.getMainContainer();$("#"+this.name).remove(),e.append(t),this.getContainer(!0)},Error.prototype.onFocus=function(){},Error.prototype.hide=function(){var t=this.getContainer(),e=this;this.data.title=null,this.data.message=null,t.addClass("hidden"),setTimeout(function(){e.destroy()},200)},Error.prototype.onBlur=function(){},Error.prototype.close=function(){this.data.critical?window.close():(this.current_section=null,UiManager.getInstance().closeComponent(),this.onConfirm&&(this.onConfirm.call(),this.onConfirm=null))},Error.prototype.onKeyPress=function(t){"button"===this.current_section&&this.onButtonKeyPress(t)},Error.prototype.onButtonKeyPress=function(t){this.getContainer(),this.list_opts;this.close()},ExitApp.prototype=Object.create(UiComponent.prototype),ExitApp.prototype.name="ExitApp",ExitApp.prototype.show=function(t){console.log("data",t),this.data.title="¿Deseas salir de esta app ?",this.data.opts=[{label:"Cancelar",action:this.closeComponent},{label:"Salir",action:this.closeApp}],this.render(),this.initComponents()},ExitApp.prototype.render=function(){var t=UiComponent.prototype.render.call(this),e=ViewManager.getMainContainer();$("#"+this.name).remove(),e.append(t),this.getContainer(!0)},ExitApp.prototype.initComponents=function(){this.buttons=new ListComponent("container-opts",{selector:".item"},this.data.opts),this.buttons.setFocusIndex(0)},ExitApp.prototype.onFocus=function(){},ExitApp.prototype.onKeyPress=function(t){var e=this.buttons;switch(t){case AppActions.back:case AppActions.menu:this.closeComponent();break;case AppActions.moveLeft:e.previousItem();break;case AppActions.moveRight:e.nextItem();break;case AppActions.select:e.getFocusItem().data("data").action.apply(this)}},ExitApp.prototype.hide=function(t){this.getContainer().removeClass("active"),t||setTimeout(function(){this.getContainer(!0).empty(),this.getContainer().remove()}.bind(this),200)},ExitApp.prototype.closeComponent=function(){UiManager.getInstance().closeComponent()},ExitApp.prototype.closeApp=function(){window.close()},ExitApp.prototype.onBlur=function(){},KeyboardComponent.prototype=Object.create(UiComponent.prototype),KeyboardComponent.prototype.name="KeyboardComponent",KeyboardComponent.prototype.DataKeyboard={},KeyboardComponent.prototype.DataKeyboard.Row0={id:"KeyboardRow0",data:[{char:"1",special:"1"},{char:"2",special:"2"},{char:"3",special:"3"},{char:"4",special:"4"},{char:"5",special:"5"},{char:"6",special:"6"},{char:"7",special:"7"},{char:"8",special:"8"},{char:"9",special:"9"},{char:"0",special:"0"}]},KeyboardComponent.prototype.DataKeyboard.Row1={id:"KeyboardRow1",data:[{char:"q",special:"<"},{char:"w",special:">"},{char:"e",special:"["},{char:"r",special:"]"},{char:"t",special:"{"},{char:"y",special:"}"},{char:"u",special:"("},{char:"i",special:")"},{char:"o",special:"¿"},{char:"p",special:"?"}]},KeyboardComponent.prototype.DataKeyboard.Row2={id:"KeyboardRow2",data:[{char:"a",special:"^"},{char:"s",special:"&"},{char:"d",special:"$"},{char:"f",special:"%"},{char:"g",special:'"'},{char:"h",special:"-"},{char:"j",special:"_"},{char:"k",special:"*"},{char:"l",special:"¡"},{char:"ñ",special:"!"}]},KeyboardComponent.prototype.DataKeyboard.Row3={id:"KeyboardRow3",data:[{char:"z",special:"+"},{char:"x",special:"="},{char:"c",special:"."},{char:"v",special:":"},{char:"b",special:";"},{char:"n",special:","},{char:"m",special:"#"},{char:"@",special:"@"},{char:"#",special:"/"},{char:".",special:"'"}]},KeyboardComponent.prototype.DataKeyboard.Row4={id:"KeyboardRow4",data:[]},KeyboardComponent.prototype.DataKeyboard.Querty={id:"KeyboardQuerty",data:[]},KeyboardComponent.prototype.DataKeyboard.Row5={id:"KeyboardRow5",data:[]},KeyboardComponent.prototype.DataKeyboard.Row6={id:"KeyboardRow6",data:[]},KeyboardComponent.prototype.render=function(t){var e=ViewManager.getMainContainer(),o=UiComponent.prototype.render.call(this);$("#"+this.name).remove(),e.append(o)},KeyboardComponent.prototype.initialize=function(){this.getDomElements(),this.caps=!1,this.shiftOn=!1,this.specials=!1,this.block=!1,this.keyword="",this.section="qwerty"},KeyboardComponent.prototype.getDomElements=function(){if(this.container=$("#"+this.id),this.input=document.getElementById("input"),this.jsqwerty=document.getElementById("KeyboardQuerty"),this.count=this.container.find(".char-counter"),this.keys_container=this.container.find(".qwerty"),this.msg_container=this.container.find(".message"),this.search_history_container=this.container.find("#recent-search"),this.baseScrollHeight=this.input.scrollHeight,0<this.config.title.length&&this.setTitle(),this.setInitialString(),this.container.find("#input").keypress(function(t){return!1}.bind(this)),"M394"==Util.getUserAgent())return!0;$("#input").keyup(function(t){t=t.keyCode;8===t&&(this.keyword=this.input.value,this.updateCharCount()),13===t&&this.validate()}.bind(this))},KeyboardComponent.prototype.enableSpecialChars=function(t){t||(this.container.find(".special").remove(),this.keys_disables=[7,8,9],this.lists[3].getItem(7).attr("data-letter",""),this.lists[3].getItem(8).attr("data-letter",""),this.lists[3].getItem(9).attr("data-letter",""),this.lists[4].getItem(2).remove(),this.lists[4].resetItems(),this.DataKeyboard.chars={0:["0"],1:["1"],2:["a","b","c","2"],3:["d","e","f","3"],4:["g","h","i","4"],5:["j","k","l","5"],6:["m","n","o","6"],7:["p","q","r","s","7"],8:["t","u","v","8"],9:["w","x","y","z","9"]})},KeyboardComponent.prototype.onFocusMain=function(t,e){e=e.data("data");t?e.setFocusIndex(this.lastfocus):this.lastfocus=e.offFocus()},KeyboardComponent.prototype.initComponents=function(){var t,e,o={selector:".key"},s={selector:".row",onFocus:this.onFocusMain};this.lists=[new ListComponent(this.DataKeyboard.Row0.id,o),new ListComponent(this.DataKeyboard.Row1.id,o),new ListComponent(this.DataKeyboard.Row2.id,o),new ListComponent(this.DataKeyboard.Row3.id,o),new ListComponent(this.DataKeyboard.Row4.id,o)],this.keysQuerty=new ListComponent(this.DataKeyboard.Querty.id,s,this.lists),this.keysQuerty.setFocusIndex(0),this.optionsList=new ListComponent(this.DataKeyboard.Row5.id,o),this.commandsList=new ListComponent(this.DataKeyboard.Row6.id,o),this.lists[0].setFocusIndex(0),this.optionsList.setFocusIndex(0),this.optionsList.offFocus(),this.commandsList.setFocusIndex(0),this.commandsList.offFocus(),this.config.showRecentSearch&&(t=this.DataKeyboard.busquedas,e=Templates.RecentSearch({keywords:t}),this.search_history_container.empty().html(e)),this.config.showAutoComplete&&(t=this.config.autoCompleteData,e=Templates.RecentSearch({keywords:t}),this.search_history_container.empty().html(e)),this.createSearchHistoryBar(),this.enableSpecialChars(this.config.enableSpecials)},KeyboardComponent.prototype.processCommand=function(){switch(this.optionsList.getFocusIndex()){case 0:this.toggleCaps();break;case 1:this.toggleSpecial()}},KeyboardComponent.prototype._removePlaceHolder=function(){"_"===this.input.value.charAt(this.input.value.length-1)&&(this.input.value=this.input.value.slice(0,-1))},KeyboardComponent.prototype.validate=function(){this._removePlaceHolder(),this.keyword=this.input.value,"number"==typeof this.config.maximumChars&&(this.config.maximumChars<=0||this.keyword.length<=this.config.maximumChars?this.config.minimumChars<=0||this.keyword.length>=this.config.minimumChars?"function"==typeof this.config.validateCallback?this.config.validateCallback(this.keyword,this.originalText).then(function(){this.keyword=this.config.isPassword?this.originalText:this.keyword,this.hide()}.bind(this),function(){this.setMsgError(this.config.msgErrorCallback)}.bind(this)):(this.keyword=this.config.isPassword?this.originalText:this.keyword,this.hide()):this.setMsgError(this.config.msgErrorMinimun):this.setMsgError(this.config.msgErrorMaximun))},KeyboardComponent.prototype.setMsgError=function(t){this.msgErrorVisible=!0,this.msg_container.html(t),this.msg_container.addClass("error")},KeyboardComponent.prototype.setTitle=function(){this.msgErrorVisible=!1,this.msg_container.removeClass("error"),this.msg_container.html(this.config.title)},KeyboardComponent.prototype.hidePasswordText=function(t){return t.replace(/./g,"*")},KeyboardComponent.prototype.setInitialString=function(){0<this.config.initialValue.length?(this.input.value=this.originalText=this.config.initialValue,this.config.isPassword&&(this.input.value=this.hidePasswordText(this.input.value)),this.input.value+="",this.adjustClassCount(),this.updateCharCount()):this.input.value=""},KeyboardComponent.prototype.processOptions=function(){switch(this.commandsList.getFocusIndex()){case 0:this.backSpace();break;case 1:this.validate()}},KeyboardComponent.prototype.toggleCaps=function(){var t=this.optionsList.getItem(0);if(!this.specials)switch(!0){case this.caps:t.removeClass("shift on"),this.keys_container.addClass("no-caps"),this.shiftOn=!1,this.caps=!1;break;case!this.shiftOn&&!this.caps:this.shiftOn=!0,this.caps=!1,t.removeClass("on").addClass("shift"),this.keys_container.removeClass("no-caps");break;case this.shiftOn&&!this.caps:this.caps=!0,this.shiftOn=!1,t.addClass("on")}},KeyboardComponent.prototype.toggleSpecial=function(){var t=this.optionsList.getItem(1);this.specials?(!1===this.caps&&!1===this.shiftOn&&this.keys_container.removeClass("special").addClass("no-caps"),t.removeClass("abc"),this.keys_container.removeClass("special"),this.specials=!1):(t.addClass("abc"),this.keys_container.removeClass("no-caps").addClass("special"),this.specials=!0)},KeyboardComponent.prototype.adjustClassCount=function(){this.count.removeClass("orange red");var t=this.input.value.length,e=this.config.changeCounterColor;switch(!0){case 60<t&&e&&t<198:this.count.addClass("orange");break;case 199<t&&e:this.count.addClass("red");break;case e&&t<this.config.minimumChars:this.count.removeClass("red")}},KeyboardComponent.prototype.setSearchText=function(t,e){this.input.value.length>=this.limit||(!this.shiftOn&&!this.caps||e||(t=t.toUpperCase()),this.originalText=this.originalText+t,this._removePlaceHolder(),this.keyword=this.config.isPassword?this.input.value+"*":this.input.value+t,this.input.value=this.keyword+"",this.autoExpandTextArea(),this.updateCharCount(),this.adjustClassCount(),this.shiftOn&&!this.caps&&(this.caps=!0,this.toggleCaps()))},KeyboardComponent.prototype.autoExpandTextArea=function(){var t,e=this.getContainer().find("#input")[0],o=0|e.getAttribute("data-min-rows");e.rows=o,t=Math.ceil((e.scrollHeight-this.baseScrollHeight)/25),e.rows=o+t},KeyboardComponent.prototype.getText=function(){return this.keyword},KeyboardComponent.prototype.backSpace=function(){this._removePlaceHolder();var t=this.input.value;this.keyword=t.replace(/.$/,""),0===t.length&&(this.keyword=""),this.originalText=this.originalText.slice(0,-1),this.input.value=this.keyword,this.autoExpandTextArea(),this.updateCharCount(),this.adjustClassCount()},KeyboardComponent.prototype.show=function(){this.render(),this.initialize(),this.getSearchHistory(),this.initComponents(),setTimeout(this.doShow.bind(this),0)},KeyboardComponent.prototype.doShow=function(){var t=this.getContainer(!0);this.config.startWithCaps&&this.optionsList&&(this.optionsList.getItem(0).addClass("shift"),this.shiftOn=!1,this.caps=!1,this.toggleCaps()),t.removeClass(this.hidden_class)},KeyboardComponent.prototype.hide=function(){this.fire("hide"),this.originalText="",this.block=!1;var t=this.getContainer();t.addClass(this.hidden_class),$("#input").unbind("keyup"),setTimeout(function(){t.remove()},200)},KeyboardComponent.prototype.evalTextInput=function(t){var e=t.getFocusItem();!this.config.enableSpecials&&this.lists[3].hasFocus()&&-1<this.keys_disables.indexOf(t.getFocusIndex())||(this.msgErrorVisible&&this.setTitle(),this.input.value.length!==this.config.maximumChars&&(t=this.specials?e.attr("data-special"):e.attr("data-letter"),this.setSearchText(t)))},KeyboardComponent.prototype.updateCharCount=function(){var t=this.config.counterMode,e=-1,o=this.config.maximumChars,s=this.input.value.length;"increment"===t&&(e=1,o=0),this.count.html(o+(s*=e))},KeyboardComponent.prototype.doChangeListFocus=function(t,e){this.lists[t].offFocus(),e?this.commandsList.setFocusIndex(t=1<=t?1:t):this.optionsList.setFocusIndex(t=1<t?1:0)},KeyboardComponent.prototype.changeListHorizontal=function(t,e,o,s){var i=!1,n=this.keysQuerty.getFocusIndex();return this.block=!0,e?0===t&&s===AppActions.moveLeft&&(this.doChangeListFocus(n,!1),this.setSection("commands"),i=!0):o.length-1===t&&s===AppActions.moveRight&&(i=!(2===n&&!this.config.enableSpecials||(this.doChangeListFocus(n,!0),this.setSection("options"),0))),this.block=!1,i},KeyboardComponent.prototype.setSection=function(t){switch(this.section=t){case"qwerty":case"commands":case"options":case"exit":break;case"input":this.input.focus(),setTimeout(this.setCursorPosition.bind(this,this.input.value.length),0)}},KeyboardComponent.prototype.onKeyPress=function(t){if(this.block)console.log("block!!");else switch(this.section){case"qwerty":this.qwertyActionHandler(t);break;case"commands":this.commandsActionHandler(t);break;case"options":this.optionsActionHandler(t);break;case"input":this.inputActionHandler(t);break;case"recent-keyword":this.searchHistoryActionHandler(t);break;case"exit":this.onKeyPressExit(t)}},KeyboardComponent.prototype.onKeyPressExit=function(t){switch(t){case AppActions.moveLeft:case AppActions.moveDown:$("#"+this.name).find(".exit").removeClass("active"),this.setSection("input"),this.input.focus();break;case AppActions.select:case AppActions.back:case AppActions.menu:this.hide()}},KeyboardComponent.prototype.qwertyActionHandler=function(t){var e,o,s,i=this.keysQuerty.getFocusItem().data("data");this.optionsList.getLastFocusItem();switch(t){case AppActions.moveLeft:case AppActions.moveRight:e=i.getFocusIndex(),o=i;break;case AppActions.moveUp:case AppActions.moveDown:e=this.keysQuerty.getFocusIndex(),o=this.keysQuerty}switch(t){case AppActions.moveLeft:this.changeListHorizontal(e,!0,o,t)||i.previousItem();break;case AppActions.moveRight:this.changeListHorizontal(e,!1,o,t)||i.nextItem();break;case AppActions.moveUp:if(4===e){if(this._lastSection)return s="commands"!==this._lastSection,this.doChangeListFocus(this.keysQuerty.getFocusIndex(),s),this.setSection(this._lastSection),void(this._lastSection="");this.keysQuerty.previousItem(),this.lists[4].offFocus();1===this.lists[3].lastFocus||this.lists[2].lastFocus;this.lists[3].setFocusIndex(this.lists[3].lastFocus),this.lists[3].lastFocus||this.lists[3].setFocusIndex(0)}else 0===e?this.switchInputSection(5,!0,i.getFocusIndex(this.lastFocus)):this.keysQuerty.previousItem();break;case AppActions.moveDown:4!==e&&(3===e?(s=i.getFocusIndex()<=9?0:1,i.offFocus(),this.keysQuerty.nextItem(),this.lists[4].setFocusIndex(s)):this.keysQuerty.nextItem());break;case AppActions.qaControl:case AppActions.qaControl2:case AppActions.qaControl3:case AppActions.qaControl4:case AppActions.qaControl5:case AppActions.qaControl6:case AppActions.qaControl7:case AppActions.qaControl8:case AppActions.qaControl9:case AppActions.qaControl0:this.processNumericButton(t);break;case AppActions.select:this.evalTextInput(i);break;case AppActions.backspace:this.backSpace();break;case AppActions.menu:case AppActions.back:this.hide();break;default:this.processSingleChar(t)}},KeyboardComponent.prototype.optionsActionHandler=function(t){var e=this.commandsList;switch(t){case AppActions.moveLeft:this.changeOptCmd(e,!1);break;case AppActions.moveRight:e.offFocus(),this.optionsList.setFocusIndex(0),this.setSection("commands");break;case AppActions.moveUp:0===e.getFocusIndex()?this.switchInputSection(4,!0):e.previousItem();break;case AppActions.moveDown:1===e.getFocusIndex()?(e.offFocus(),this.keysQuerty.setFocusIndex(4),this.keysQuerty.getFocusItem().data("data").setFocusIndex(0),this._lastSection="options",this.setSection("qwerty")):e.nextItem();break;case AppActions.select:this.processOptions();break;case AppActions.menu:case AppActions.back:this.hide();break;case AppActions.backspace:this.backSpace();break;default:this.processSingleChar(t)}},KeyboardComponent.prototype.changeOptCmd=function(t,e){this.block=!0;var o=this.keysQuerty.getFocusIndex(),s=this.keysQuerty.getFocusItem().data("data"),i=s.length-1,s=s.getLastFocusIndex(),n=0;switch(!0){case s===i&&!e:0===t.getFocusIndex()&&(o=0,i=9),1===t.getFocusIndex()&&(o=1,i=9),n=i;break;case s===i&&e:n=o=0;break;case 0===s&&!e:1===t.getFocusIndex()&&(o=1),0===t.getFocusIndex()&&(o=0),n=i}if(e)switch(t.getFocusIndex()){case 0:o=0;break;case 1:o=2}this.keysQuerty.setFocusIndex(o),this.keysQuerty.getFocusItem().data("data").setFocusIndex(n),t.offFocus(),this.setSection("qwerty"),this.block=!1},KeyboardComponent.prototype.commandsActionHandler=function(t){var e=this.optionsList;switch(t){case AppActions.moveRight:this.changeOptCmd(e,!0);break;case AppActions.moveLeft:var o=e.getFocusIndex();e.offFocus(),this.commandsList.setFocusIndex(o),this.setSection("options");break;case AppActions.backspace:this.backSpace();break;case AppActions.moveUp:0===e.getFocusIndex()?this.switchInputSection(this.lastFocusSection,!0):e.previousItem();break;case AppActions.moveDown:1===e.getFocusIndex()?(e.offFocus(),this.keysQuerty.setFocusIndex(4),this.keysQuerty.getFocusItem().data("data").setFocusIndex(0),this._lastSection="commands",this.setSection("qwerty")):e.nextItem();break;case AppActions.select:this.processCommand();break;case AppActions.menu:case AppActions.back:this.hide();break;default:this.processSingleChar(t)}},KeyboardComponent.prototype.switchInputSection=function(t,e,o){this.lastFocusSection=t;var s=this.DataKeyboard.busquedas||0<this.DataKeyboard.busquedas.length,i=0;switch((s=this.DataKeyboard.busquedas&&0!==this.DataKeyboard.busquedas.length?s:!1)&&(i=this.search_history_list.data.length),this.section){case"commands":e&&(s||this.config.showAutoComplete?(this.optionsList.offFocus(),this.search_history_list.lastFocus?this.search_history_list.setFocusIndex(this.search_history_list.lastFocus):this.search_history_list.setFocusIndex(0),this.lastFocusSection=5,this.setSection("recent-keyword")):(this.lastFocusSection=5,this.lists[5]=this.optionsList,this.lists[5].offFocus(),this.setSection("input")));break;case"qwerty":e&&(s||this.config.showAutoComplete?(this.search_history_list.lastFocus||(this.search_history_list.lastFocus=0),this.lastFocusSection=0,this.lists[0].offFocus(),this.search_history_list.setFocusIndex(this.search_history_list.lastFocus),this.setSection("recent-keyword")):(this.lastFocusSection=0,this.lists[0].offFocus(),this.setSection("input")));break;case"options":e&&(s||this.config.showAutoComplete?(this.commandsList.offFocus(),(this.search_history_list.lastFocus||i)&&this.search_history_list.setFocusIndex(this.search_history_list.lastFocus||0),i||this.search_history_list.lastFocus||this.search_history_list.setFocusIndex(0),this.lastFocusSection=4,this.setSection("recent-keyword")):(this.lastFocusSection=4,this.lists[4]=this.commandsList,this.commandsList.offFocus(),this.setSection("input")));break;case"recent-keyword":if(e)this.lastFocusSection=this.lastFocusSection,this.search_history_list.offFocus(),this.setSection("input");else{if(4===this.lastFocusSection){this.search_history_list.offFocus(),this.commandsList.setFocusIndex(0),this.setSection("options");break}if(5===this.lastFocusSection){this.search_history_list.offFocus(),this.optionsList.setFocusIndex(0),this.setSection("commands");break}this.keysQuerty.setFocusIndex(0),this.lists[0].setFocusIndex(this.lastFocus);this.search_history_list.offFocus(),this.setSection("qwerty")}break;case"input":e||(s||this.config.showAutoComplete?(console.log("if dentro de primer if"),this.search_history_list.setFocusIndex(this.search_history_list.lastFocus),this.input.blur(),this.setSection("recent-keyword")):(this.setCursorPosition(this.input.value.length-1),this.input.blur(),0===this.lastFocusSection?(this.lists[this.lastFocusSection].setFocusIndex(this.lists[0].lastFocus),this.setSection("qwerty")):4===this.lastFocusSection?(this.commandsList.setFocusIndex(this.lastFocus),this.setSection("options")):(this.setSection(4===this.lastFocusSection?"options":"commands"),this.lists[this.lastFocusSection].setFocusIndex(this.lastFocus))))}},KeyboardComponent.prototype.searchHistoryActionHandler=function(t){switch(t){case AppActions.moveRight:this.search_history_list.nextItem();break;case AppActions.moveLeft:this.search_history_list.previousItem();break;case AppActions.moveDown:this.switchInputSection(this.lastFocusSection);break;case AppActions.moveUp:this.switchInputSection(this.lastFocusSection,!0);break;case AppActions.select:this.appendSearchHistoryWords();break;case AppActions.backspace:this.backSpace();break;case AppActions.menu:case AppActions.back:this.hide()}},KeyboardComponent.prototype.appendSearchHistoryWords=function(){var t=this.search_history_list.getFocusItem().data("data"),t=t||"";this.evalDuplicatedSearch(t),this.config.showAutoComplete?this.setSearchText(t,!0):(this.input.value=t,this.validate())},KeyboardComponent.prototype.evalDuplicatedSearch=function(t){for(var e=!1,o=this.DataKeyboard.busquedas.length,s=this.DataKeyboard.busquedas,i=0;i<o&&!(e=s[i].trim().toLowerCase()===t.trim().toLowerCase());i++);this.searchWordExist=e},KeyboardComponent.prototype.createSearchHistoryBar=function(){0<this.DataKeyboard.busquedas.length&&this.config.showRecentSearch&&(this.search_history_list=new ScrollListComponent("recent-list",{selector:".search-keyword",maxFocusIndex:4},this.DataKeyboard.busquedas)),this.config.showAutoComplete&&(this.search_history_list=new ScrollListComponent("recent-list",{selector:".search-keyword",maxFocusIndex:5},this.config.autoCompleteData))},KeyboardComponent.prototype.getIndexToNextList=function(t){var e=this.search_history_list.getFocusIndex(),o=this.search_history_list.length,s=0;switch(t&&this.lists[0].lastFocus,!0){case 0===e:this.lastFocusSection=5,s=0;break;case 6<o&&(e===o-1||e===o-2):this.lastFocusSection=4,s=0;break;case 6<o&&e<o-2:this.lastFocusSection=0,s=this.defineIndex(e);break;case o<=6&&0<e&&(e<o-1||0<e):this.lastFocusSection=5===e||6===e?4:0,s=this.defineIndex(e)}return s},KeyboardComponent.prototype.defineIndex=function(t){var e=[0,0,3,6,9];return e-1<t?0:e[t]},KeyboardComponent.prototype.validateFileExist=function(){var t=Sagem.Get("FS","LS","/flash").split(",");-1===$.inArray("search_history",t)&&Sagem.Set("FS","MKDIR","/flash/search_history/","RETURN_CODES")},KeyboardComponent.prototype.getSearchHistory=function(){this.validateFileExist();var t=this.hasSearchHistoryStored(!0);if(this.config.showRecentSearch)if(void 0!==t)try{var e=t.blim;"object"!=typeof e?this.DataKeyboard.busquedas=[]:(this.DataKeyboard.busquedas=e).length}catch(t){console.log("err: ",t),this.DataKeyboard.busquedas=[]}else this.DataKeyboard.busquedas=[];else this.DataKeyboard.busquedas=[]},KeyboardComponent.prototype.saveSearchHistory=function(){var t,e,o;this.config.showRecentSearch&&!this.searchWordExist&&(4===(t=this.DataKeyboard.busquedas).length&&t.pop(),t.splice(0,0,this.keyword),e={},void 0!==(o=this.hasSearchHistoryStored(!0))?(o.blim=t,e=o):e.blim=t,o=JSON.stringify(e),Sagem.Set("FS","FILE",AppConfig.urlSearchFile,o,"RETURN_CODES"))},KeyboardComponent.prototype.deleteSearchHistory=function(){var t=this.hasSearchHistoryStored(!0),t=(void 0!==t&&(t.blim=[]),JSON.stringify(t));0==Sagem.Set("FS","FILE",AppConfig.urlSearchFile,t,"RETURN_CODES")&&(this.search_history_container.empty(),this.search_history_list.resetItems(),this.search_history_list.offFocus(),this.DataKeyboard.busquedas=[],this.setSection("qwerty"),this.keysQuerty.setFocusIndex(0),this.lists[0].setFocusIndex(0))},KeyboardComponent.prototype.hasSearchHistoryStored=function(t){var e=Sagem.Get("FS","FILE",AppConfig.urlSearchFile);return e&&"object"==typeof(e=JSON.parse(e))&&void 0!==e&&"object"==typeof e?t?e:0:t?void 0:-1},KeyboardComponent.prototype.inputActionHandler=function(t){switch(t){case AppActions.moveDown:case AppActions.moveUp:break;case AppActions.qaControl:case AppActions.qaControl2:case AppActions.qaControl3:case AppActions.qaControl4:case AppActions.qaControl5:case AppActions.qaControl6:case AppActions.qaControl7:case AppActions.qaControl8:case AppActions.qaControl9:case AppActions.qaControl0:this.processNumericButton(t);break;case AppActions.backspace:this.backSpace();break;case AppActions.menu:case AppActions.back:this.hide()}},KeyboardComponent.prototype.DataKeyboard.chars={0:[" ","0"],1:[".","@","/","1"],2:["a","b","c","2"],3:["d","e","f","3"],4:["g","h","i","4"],5:["j","k","l","5"],6:["m","n","o","6"],7:["p","q","r","s","7"],8:["t","u","v","8"],9:["w","x","y","z","9"]},KeyboardComponent.prototype.selectKey=function(t,e){if(this.evalNumericButton(t)&&"/"!=t&&!this.specials){var o='[data-letter="'+t.toLowerCase()+'"]',o=this.jsqwerty.querySelector(o),s=e?" active":"",i="";switch(!0){case" "!=t&&"0"!=t:i="key "+s;break;case"0"==t:i="key zero-key "+s;break;case" "==t:i="key space-bar "+s;break;default:i="key"+s}o.setAttribute("class",i)}},KeyboardComponent.prototype.processNumericButton=function(t){if(this.block=!0,this.keysQuerty.offFocus(),this.input.value.length===this.config.maximumChars)this.keysQuerty.offFocus(),this.commandsList.setFocusIndex(1),this.setSection("options"),this.block=!1;else{"credit"==this.config.type&&(1==this.originalText.length&&3==this.input.value.substr(0,1)?(this.config.title="Ingresa los 15 dígitos de tu tarjeta de crédito o débito",this.config.msgErrorMinimun="Debes ingresar los 15 dígitos de la tarjeta",this.config.maximumChars=15,this.config.minimumChars=15,this.container.find(".message").html(this.config.title)):(1==this.originalText.length&&4==this.input.value.substr(0,1)||5==this.input.value.substr(0,1))&&(this.config.title="Ingresa los 16 dígitos de tu tarjeta de crédito o débito",this.config.msgErrorMinimun="Debes ingresar los 16 dígitos de la tarjeta",this.container.find(".message").html(this.config.title),this.config.maximumChars=16,this.config.minimumChars=16)),this.lasttime||(this.current_num=t,this.puntero=0,this.lasttime=new Date);var e,o=new Date,s=this.getChar(t,this.puntero);if(!1===s)e=this.DataKeyboard.chars[t][this.puntero=0],this.appendChar(e),this.lasttime=new Date,this.block=!1,this.selectKey(e,!0),setTimeout(this.selectKey.bind(this,e,!1),50);else if(this.input.value.length<=0)this.appendChar(s),this.lasttime=new Date,this.block=!1,this.selectKey(s,!0),setTimeout(this.selectKey.bind(this,s,!1),70);else{var i=o.getSeconds()-this.lasttime.getSeconds(),n=(!(this.current_num===t&&i<=1)||this.puntero===this.DataKeyboard.chars[t].length-1?this.puntero=0:this.puntero++,s=this.getChar(t,this.puntero),this.selectKey(s,!0),setTimeout(this.selectKey.bind(this,s,!1),70),this.getSelectionStart());switch(!0){case this.current_num===t:i<=1?this.replaceChar(n,s,i):this.appendChar(s);break;case this.current_num!==t:this.appendChar(s)}this.autoExpandTextArea(),this.adjustClassCount(),this.lasttime=o,this.current_num=t,this.block=!1}}},KeyboardComponent.prototype.getSelectionStart=function(){return this.input.selectionStart},KeyboardComponent.prototype.appendChar=function(t){var e,o,s;this.evalNumericButton(t)&&(this._removePlaceHolder(),e=this.getSelectionStart(),s=this.input.value.split(""),o=this.originalText.split(""),this.shiftOn&&!this.caps&&(t=t.toUpperCase(),this.caps=!0,this.shiftOn=!1,this.toggleCaps()),o.splice(e,0,t),t=this.config.isPassword?"*":t,s.splice(e,0,t),t=s.join(""),s=o.join(""),this.input.value=t+"",this.keyword=t,this.originalText=s,this.updateCharCount(),"input"===this.section)&&this.setCursorPosition(e+1)},KeyboardComponent.prototype.replaceChar=function(t,e,o){var s,i;this.evalNumericButton(e)&&(this._removePlaceHolder(),this.shiftOn&&!this.caps&&(e=e.toUpperCase(),this.caps=!0,this.shiftOn=!1,this.toggleCaps()),i=this.input.value.split(""),(s=this.originalText.split("")).splice(t-1,1,e),e=this.config.isPassword?"*":e,i.splice(t-1,1,e),e=i.join(""),i=s.join(""),this.input.value=e+"_",this.keyword=e,this.originalText=i,"input"===this.section)&&(o<=1?this.setCursorPosition(t):this.setCursorPosition(t+2))},KeyboardComponent.prototype.evalNumericButton=function(t){return this.msgErrorVisible&&this.setTitle(),!(!this.config.enableSpecials&&-1<[".","/","@"].indexOf(t))},KeyboardComponent.prototype.getChar=function(t,e){return 1!==this.DataKeyboard.chars[t].length&&this.DataKeyboard.chars[t][e]},KeyboardComponent.prototype.setCursorPosition=function(t){this.input.selectionStart=t,this.input.selectionEnd=t},KeyboardComponent.prototype.processSingleChar=function(t){void 0===t||""===t||null===t||"string"==typeof t&&1<t.length||this.setSearchText(t)},KeyboardComponent.prototype.onFocus=function(){},LandingPage.prototype=Object.create(UiComponent.prototype),LandingPage.prototype.name="LandingPage",LandingPage.prototype.show=function(t){this.render(t);this.headerList=new ListComponent("header-container",{selector:"div"},[{id:"return"},{id:"cancel"}])},LandingPage.prototype.onError=function(t){console.error("on Error",t)},LandingPage.prototype.render=function(t){var e=UiComponent.prototype.render.call(this),o=ViewManager.getMainContainer();$("#"+this.name).remove(),o.append(e),this.getContainer(!0),this.pages=new Pages(t),this.currentSection="pages"},LandingPage.prototype.onKeyPress=function(t){switch(this.currentSection){case"header":this.onHeaderKeyPress(t);break;case"cardBack":this.oncardBacksKeyPress(t);break;case"pages":this.onPagesKeyPress(t)}},LandingPage.prototype.onFocusHeader=function(){this.headerList.setFocusIndex(0)},LandingPage.prototype.onHeaderKeyPress=function(t){switch(t){case AppActions.select:var e=this.headerList.getFocusItem().data("data");this.onHeaderSelected(e);break;case AppActions.moveLeft:case AppActions.moveRight:break;case AppActions.moveDown:this.onBlurHeader();break;case AppActions.menu:case AppActions.back:this.onHeaderSelected(e)}},LandingPage.prototype.onBlurHeader=function(){this.headerList.offFocus(),0!=this.pages.currentPage?this.onFocusCardBack():(this.currentSection="pages",this.pages.onFocus())},LandingPage.prototype.onFocusCardBack=function(){this.currentSection="cardBack",$("#botton-back").addClass("active"),$("#resume").addClass("active"),this.pages.blur()},LandingPage.prototype.onBlurCardBack=function(t){"pages"==(this.currentSection=t)?this.pages.onFocus():this.onFocusHeader(),$("#resume").removeClass("active"),$("#botton-back").removeClass("active")},LandingPage.prototype.onHeaderSelected=function(t){UiManager.getInstance().openComponent("ExitApp",{},!0,!0,!0)},LandingPage.prototype.oncardBacksKeyPress=function(t){switch(t){case AppActions.moveUp:this.onFocusHeader(),this.onBlurCardBack("header");break;case AppActions.select:this.onBackSelected();case AppActions.moveDown:this.onBlurCardBack("pages");break;case AppActions.menu:case AppActions.back:break;default:console.log("actions",t)}},LandingPage.prototype.onBackSelected=function(t){this.pages.prevPage(!1)},LandingPage.prototype.onPagesKeyPress=function(t){t===AppActions.moveUp?this.onMoveUpPages():this.pages.onKeyPress(t)},LandingPage.prototype.onMoveUpPages=function(){0!=this.pages.currentPage?this.onFocusCardBack():(this.onFocusHeader(),this.pages.blur(),this.currentSection="header")},LandingPage.prototype.onBlur=function(){console.log("onBlur"),this.getContainer().hide()},LandingPage.prototype.onFocus=function(){console.log("on Focus"),this.getContainer().show()},LandingPage.prototype.hide=function(t){var e=this.getContainer(!0);e.empty(),e.remove()},NipComponent.prototype=Object.create(UiComponent.prototype),NipComponent.prototype.name="NipComponent",NipComponent.prototype.show=function(t){var e=this.name;this.paymentSelected=t.paymentSelected,this.nip_index=0,this.nip=[],this.item=t.selectedItem,this.keyCode=t.keyCode,this.summary=t.summary,this.initialize(),this.data.disclaimer=this.getDisclaimerText(t.selectedItem),this.render(),this.getContainer(!0),this.setSection("nip"),setTimeout(function(){$("#"+e).addClass("shown")},100)},NipComponent.prototype.getDisclaimerText=function(t){return t&&t.isPhone()?"Llegará un SMS con un token a tu celular registrado <br>con terminación "+t.getValue()+", ingrésalo para confirmar.":"Llegará un un token a tu correo "+t.getValue()+", ingrésalo para confirmar."},NipComponent.prototype.render=function(){var t=UiComponent.prototype.render.call(this),e=ViewManager.getMainContainer();$("#"+this.name).remove(),e.append(t)},NipComponent.prototype.initialize=function(){},NipComponent.prototype.onFocus=function(){},NipComponent.prototype.onBlur=function(){},NipComponent.prototype.onNipKeyPress=function(t){switch(t){case AppActions.qaControl:case AppActions.qaControl1:case AppActions.qaControl2:case AppActions.qaControl3:case AppActions.qaControl4:case AppActions.qaControl5:case AppActions.qaControl6:case AppActions.qaControl7:case AppActions.qaControl8:case AppActions.qaControl9:case AppActions.qaControl0:this.processNumber(t);break;case AppActions.moveDown:this.setSection("resend-button");break;case AppActions.select:break;case AppActions.backspace:this.deleteNipElement()}},NipComponent.prototype.processNumber=function(t){parseInt(t);var e=this.getContainer();e.find(".nip-digit").eq(this.nip.length).html("*"),e.find(".nip-digit").removeClass("active"),e.find(".nip-digit").eq(this.nip.length+1).addClass("active"),this.nip_index++,this.nip.push(t);e=this.nip.join().replace(/,/g,"");4===e.length&&this.validateCode(e)},NipComponent.prototype.sendBuyRegister=function(t){var e=ShoppingCart.getInstance(),o={},s=Totalplay.getInstance();ShoppingCart.getInstance().getProductId();return o.showAlias=e.getShowsData("alias"),o.specialEventAlias=e.getCelebration().alias,o.zoneAlias=e.getZonesData("alias"),o.datePurchase=Date.now(),o.totalPeople=e.getTicketsData("noAttendees"),o.couponPrice=e.getCouponsData("price"),o.couponValue=e.getCouponsData("price"),o.monthlyPayment=this.amount,o.showTimestamp=e.getShowsTimesData("timestamp"),o.customerName=AppConfig.profile.name,o.purchaseId=this.order.idBuy,o.orderId=this.order.idOrder,s.registerPurchase(o)},NipComponent.prototype.validateCode=function(t){this.setSection(""),UiManager.setLoading(),Totalplay.getInstance().validateSendPhoneCode(this.keyCode,t).then(function(t){this.nextStep()}.bind(this),function(t){this.deleteNipArray(),this.getContainer(!0).find(".token-error-text").addClass("shown"),this.setSection("nip"),UiManager.removeLoading()}.bind(this))},NipComponent.prototype.nextStep=function(){"card"==this.paymentSelected.getType()?(UiManager.removeLoading(),UiManager.getInstance().openComponent("ConfirmCardScreen",{summary:this.summary,paymentSelected:this.paymentSelected},!0,!0)):this.makeBuyCreditTp()},NipComponent.prototype.onResendButton=function(t){switch(t){case AppActions.moveUp:this.setSection("nip");break;case AppActions.moveRight:this.setSection("wrong-number");break;case AppActions.select:this.resendCode()}},NipComponent.prototype.onWrongKeyPress=function(t){switch(t){case AppActions.moveUp:this.setSection("nip");break;case AppActions.moveLeft:this.setSection("resend-button");break;case AppActions.select:UiManager.getInstance().closeComponent()}},NipComponent.prototype.onKeyPress=function(t){switch(t){case AppActions.back:case AppActions.menu:UiManager.getInstance().closeComponent()}switch(this.current_section){case"nip":this.onNipKeyPress(t);break;case"resend-button":this.onResendButton(t);break;case"wrong-number":this.onWrongKeyPress(t)}},NipComponent.prototype.setSection=function(t){var e=this.current_section,o=this.getContainer();switch(this.current_section=t,e){case"nip":o.find(".nip-digit").removeClass("active");break;case"resend-button":o.find(".resend").removeClass("active");break;case"wrong-number":o.find(".wrong-number").removeClass("active")}switch(t){case"nip":o.find(".nip-digit").eq(this.nip.length).addClass("active");break;case"resend-button":o.find(".resend").addClass("active");break;case"wrong-number":o.find(".wrong-number").addClass("active")}},NipComponent.prototype.resendCode=function(){var t=AppConfig.profile.name,e=this.item.getSendtoCode(),e=this.item.isPhone()?{contactInfo:e}:{contactInfo:e,name:t};Totalplay.getInstance().sendPhoneCode(e).then(function(t){this.keyCode=t.secdata,this.deleteNipArray(),this.setNipFocus(),this.setSection("nip")}.bind(this),this.onError.bind(this))},NipComponent.prototype.deleteNipElement=function(){var t;0!=this.nip.length&&((t=$("#"+this.name).find(".nip-digit")).eq(this.nip_index-1).html(""),this.nip_index--,t.removeClass("active"),t.eq(this.nip_index).addClass("active"),this.nip.pop(),0===this.nip.length)&&(this.nip=[])},NipComponent.prototype.deleteNipArray=function(){$("#"+this.name).find(".nip-digit").html(""),this.nip=[],this.nip_index=0},NipComponent.prototype.hide=function(t){$("#"+this.name).removeClass("shown"),t||(this.nip=null,this.nip_index=null,this.value=null,this.current_section=null,this.data.price=null,this.data.method=null,this.data.choice=null,setTimeout(function(){this.getContainer(),this.destroy()}.bind(this),200))},NipComponent.prototype.onError=function(){UiManager.getInstance().closeComponent()},NipComponent.prototype.purchaseConfirm=function(){var e=UiManager.getInstance(),o=this;UiManager.setLoading(),this.sendBuyRegister().then(function(t){e.openComponent("Purchase",{qrImage:t.url},!0,!0),UiManager.removeLoading()},function(t){var e=UiManager.getInstance();console.error("Some error",t),t.onConfirm=o.onError,UiManager.removeLoading(),e.openComponent("Error",t)})},NipComponent.prototype.makeBuyCreditTp=function(){var o=this,t={idSummary:Util.encryptByAES(this.summary.id,AppConfig.tp_backend.key).toString(),idCard:"",ccv:"",msi:"",creditTp:1,creditTpM:this.paymentSelected.getNumberPayments()};this.amount=this.paymentSelected.getAmountInt(),Totalplay.getInstance().makeBuy(t).then(function(t){0==t.idBuy?this.onErrorBuy(t):(this.order=t,this.removeLoading(),this.purchaseConfirm())}.bind(this),function(t){var e=UiManager.getInstance();console.error("Some error",t),t.onConfirm=o.onError,UiManager.removeLoading(),e.openComponent("Error",t)})},NipComponent.prototype.showError=function(t){var e=UiManager.getInstance();t.onConfirm=this.onError,UiManager.removeLoading(),e.openComponent("Error",t)},NipComponent.prototype.onErrorBuy=function(t){data=t.idBuy?{title:"Por el momento no podemos procesar tu compra. ¡Inténtalo más tarde!",message:"",critical:!1}:{title:"Ha ocurrido un error. ¡Inténtalo más tarde!",code:t.code||500,message:"",critical:!1},this.showError(data)},NumericKeyboard.prototype=Object.create(KeyboardComponent.prototype),NumericKeyboard.prototype.name="NumericKeyboard",NumericKeyboard.prototype.DataKeyboard={},NumericKeyboard.prototype.DataKeyboard.Row0={id:"KeyboardRow0",data:[{char:"1",special:"1"},{char:"2",special:"2"},{char:"3",special:"3"}]},NumericKeyboard.prototype.DataKeyboard.Row1={id:"KeyboardRow1",data:[{char:"4",special:"4"},{char:"5",special:"4"},{char:"6",special:"6"}]},NumericKeyboard.prototype.DataKeyboard.Row2={id:"KeyboardRow2",data:[{char:"7",special:"7"},{char:"8",special:"8"},{char:"9",special:"9"}]},NumericKeyboard.prototype.DataKeyboard.Row3={id:"KeyboardRow3",data:[{char:"*",special:"*"},{char:"0",special:"0"},{char:"#",special:"#"}]},NumericKeyboard.prototype.DataKeyboard.Row4={id:"KeyboardRow4",data:[]},NumericKeyboard.prototype.DataKeyboard.Querty={id:"KeyboardQuerty",data:[]},NumericKeyboard.prototype.DataKeyboard.chars={0:["0"],1:["1"],2:["2"],3:["3"],4:["4"],5:["5"],6:["6"],7:["7"],8:["8"],9:["9"]},NumericKeyboard.prototype.initComponents=function(){var t={selector:".key"},e={selector:".row",onFocus:this.onFocusMain};this.lists=[new ListComponent(this.DataKeyboard.Row0.id,t),new ListComponent(this.DataKeyboard.Row1.id,t),new ListComponent(this.DataKeyboard.Row2.id,t),new ListComponent(this.DataKeyboard.Row3.id,t)],this.keysQuerty=new ListComponent(this.DataKeyboard.Querty.id,e,this.lists),this.keysQuerty.setFocusIndex(0),this.commandsList=new ListComponent(this.DataKeyboard.Row4.id,t),this.lists[0].setFocusIndex(0),this.commandsList.offFocus(),this.buttonBack=this.getContainer().find(".back-arrow")},NumericKeyboard.prototype.actionHandler=function(t){if(t===AppActions.menu||t===AppActions.back)this.hide();else switch(this.section){case"qwerty":this.qwertyActionHandler(t);break;case"options":this.commandsActionHandler(t);break;case"exit":this.onKeyPressExit(t)}},NumericKeyboard.prototype.onKeyPressExit=function(t){switch(t){case AppActions.moveLeft:case AppActions.moveDown:this.buttonBack.removeClass("active"),("qwerty"==this._lastSection?this.keysQuerty:this.commandsList).setFocusIndex(),this.section=this._lastSection,this._lastSection="";break;case AppActions.select:case AppActions.back:case AppActions.menu:this.hide()}},NumericKeyboard.prototype.evalTextInput=function(t){t=t.getFocusItem().attr("data-letter");"credit"==this.config.type&&(1==this.originalText.length&&3==this.input.value.substr(0,1)?(this.config.title="Ingresa los 15 dígitos de tu tarjeta de crédito o débito",this.config.msgErrorMinimun="Debes ingresar los 15 dígitos de la tarjeta",this.config.maximumChars=15,this.config.minimumChars=15,this.container.find(".message").html(this.config.title)):(1==this.originalText.length&&4==this.input.value.substr(0,1)||5==this.input.value.substr(0,1))&&(this.config.title="Ingresa los 16 dígitos de tu tarjeta de crédito o débito",this.config.msgErrorMinimun="Debes ingresar los 16 dígitos de la tarjeta",this.container.find(".message").html(this.config.title),this.config.maximumChars=16,this.config.minimumChars=16)),this.input.value.length!==this.config.maximumChars&&this.setSearchText(t)},NumericKeyboard.prototype.qwertyActionHandler=function(t){var e,o,s,i=this.keysQuerty.getFocusItem().data("data");this.commandsList.getLastFocusItem();switch(t){case AppActions.moveLeft:case AppActions.moveRight:e=i.getFocusIndex(),o=i;break;case AppActions.moveUp:case AppActions.moveDown:e=this.keysQuerty.getFocusIndex(),o=this.keysQuerty}switch(t){case AppActions.moveLeft:if(0<e&&!this.changeListHorizontal(e,!0,o,t)){if(0==e)return e=i.length-1,void i.setFocusIndex(e);i.previousItem()}break;case AppActions.moveRight:this.changeListHorizontal(e,!1,o,t)||i.nextItem();break;case AppActions.moveUp:if(1===e){if(this._lastSection)return s="commands"!==this._lastSection,this.doChangeListFocus(this.keysQuerty.getFocusIndex(),s),this.setSection(this._lastSection),void(this._lastSection="");this.keysQuerty.previousItem()}else 0==e?(this.buttonBack.addClass("active"),this.keysQuerty.offFocus(),this.section="exit",this._lastSection="qwerty"):this.keysQuerty.previousItem();break;case AppActions.moveDown:3!==e&&this.keysQuerty.nextItem();break;case AppActions.qaControl:case AppActions.qaControl2:case AppActions.qaControl3:case AppActions.qaControl4:case AppActions.qaControl5:case AppActions.qaControl6:case AppActions.qaControl7:case AppActions.qaControl8:case AppActions.qaControl9:case AppActions.qaControl0:this.processNumericButton(t);break;case AppActions.select:this.evalTextInput(i);break;case AppActions.backspace:this.backSpace();break;case AppActions.menu:case AppActions.back:this.hide();break;default:this.processSingleChar(t)}},NumericKeyboard.prototype.commandsActionHandler=function(t){var e=this.commandsList;switch(t){case AppActions.moveLeft:this.changeOptCmd(e,!1);break;case AppActions.moveRight:this.buttonBack.addClass("active"),this.commandsList.offFocus(),this.section="exit",this._lastSection="options";break;case AppActions.moveUp:0===e.getFocusIndex()?(this.buttonBack.addClass("active"),this.commandsList.offFocus(),this.section="exit",this._lastSection="options"):e.previousItem();break;case AppActions.moveDown:e.nextItem();break;case AppActions.select:this.processOptions();break;case AppActions.menu:case AppActions.back:this.hide();break;case AppActions.backspace:this.backSpace();break;default:this.processSingleChar(t)}},NumericKeyboard.prototype.setFocusOptionsList=function(){this.optionsList.setFocusIndex(0)},NumericKeyboard.prototype.changeListHorizontal=function(t,e,o,s){var i=!1,n=this.keysQuerty.getFocusIndex();return this.block=!0,e?0===t&&s===AppActions.moveLeft&&(this.doChangeListFocus(n,!1),this.setSection("commands"),i=!0):o.length-1===t&&s===AppActions.moveRight&&(i=!(2===n&&!this.config.enableSpecials||(this.doChangeListFocus(n,!0),this.setSection("options"),0))),this.block=!1,i},NumericKeyboard.prototype.changeOptCmd=function(t,e){this.block=!0;var o=this.keysQuerty.getFocusIndex(),s=this.keysQuerty.getFocusItem().data("data"),i=s.length-1,s=s.getLastFocusIndex(),n=0;switch(!0){case s===i&&!e:0===t.getFocusIndex()&&(o=0,i=2),1===t.getFocusIndex()&&(o=1,i=2),n=i;break;case s===i&&e:n=o=0;break;case 0===s&&!e:1===t.getFocusIndex()&&(o=1),0===t.getFocusIndex()&&(o=0),n=i}if(e)switch(t.getFocusIndex()){case 0:o=0;break;case 1:o=2}this.keysQuerty.setFocusIndex(o),this.keysQuerty.getFocusItem().data("data").setFocusIndex(n),t.offFocus(),this.setSection("qwerty"),this.block=!1},OptionsList.prototype=Object.create(UiComponent.prototype),OptionsList.prototype.name="OptionsList",OptionsList.prototype.show=function(t){this.paintOptions(t)},OptionsList.prototype.paintOptions=function(t){var e=t.list,o=t.parent;switch(this.data.dataOptions=null,this.block=!1,this.onSelected=t.onSelected,this.data.title=t.title,o){case"neighborhood":this.data.neighborhoods=!0,this.data.dataOptions=e,this.data.years=!1,this.data.months=!1,this.currentParent=o;break;case"years":this.data.years=!0,this.data.dataOptions=e,this.data.neighborhoods=!1,this.data.months=!1,this.currentParent=o;break;case"months":this.data.months=!0,this.data.years=!1,this.data.neighborhoods=!1,this.currentParent=o,this.data.dataOptions=e;break;case"payments":this.data.payments=!0,this.data.years=!1,this.data.neighborhoods=!1,this.currentParent=o,this.data.dataOptions=e,this.account=t.account,this.account||!this.onSelected?this.data.icono=!1:this.data.icono=!0}this.render(),this.createList(this.data.dataOptions),this.current_section="list",this.getElements(),this.less.addClass("hidden"),t.list.length<=5&&this.more.addClass("hidden")},OptionsList.prototype.render=function(){var t=UiComponent.prototype.render.call(this),e=ViewManager.getMainContainer();$("#"+this.name).remove(),e.append(t)},OptionsList.prototype.hide=function(t){var e=this.getContainer(!0),o=this;e.addClass("hidden"),setTimeout(function(){t||(o.getContainer(),o.destroy())},200)},OptionsList.prototype.onFocus=function(){this.getContainer().removeClass("hidden")},OptionsList.prototype.onBlur=function(){},OptionsList.prototype.createList=function(t){this.listOptions=new ScrollListComponent("option_list",{direction:"vertical",maxFocusIndex:4,selector:".options"},t),this.listOptions.setFocusIndex(0),this.buttonBack=this.getContainer().find(".back-arrow")},OptionsList.prototype.getElements=function(){this.less=ViewManager.getMainContainer().find(".less"),this.more=ViewManager.getMainContainer().find(".more"),this.auxA=this.getContainer().find(".auxA")},OptionsList.prototype.onKeyPress=function(t){switch(this.current_section){case"list":this.onOptionKeyPress(t);break;case"exit":this.onkeyPressButton(t)}},OptionsList.prototype.onOptionKeyPress=function(t){if(!this.block)switch(this.block=!0,window.clearTimeout(this.keyBlockPress),this.keyBlockPress=setTimeout(this.unlock.bind(this),350),t){case AppActions.moveDown:this.listOptions.nextItem(),5==this.listOptions.getFocusIndex()&&(this.less.removeClass("hidden"),this.auxA.html(this.listOptions.getFocusData(-6).month));break;case AppActions.moveUp:0===this.listOptions.getFocusIndex()?(this.listOptions.offFocus(),this.buttonBack.addClass("active"),this.current_section="exit"):(this.listOptions.previousItem(),4==this.listOptions.getFocusIndex()&&this.less.addClass("hidden"));break;case AppActions.moveRight:0===this.listOptions.getFocusIndex()&&(this.listOptions.offFocus(),this.buttonBack.addClass("active"),this.listOptions.getItem(0).removeClass("color"),this.listOptions.getItem(0).removeClass("hide"),this.listOptions.getItem(0).addClass("options"),this.current_section="exit");break;case AppActions.menu:case AppActions.back:UiManager.getInstance().closeComponent();break;case AppActions.select:this.onClose()}},OptionsList.prototype.onkeyPressButton=function(t){switch(t){case AppActions.moveDown:this.listOptions.setFocusIndex(0),this.buttonBack.removeClass("active"),this.current_section="list";break;case AppActions.menu:case AppActions.back:case AppActions.select:UiManager.getInstance().closeComponent()}},OptionsList.prototype.onClose=function(){switch(this.currentParent){case"neighborhood":this.onSelected.call(null,this.listOptions.getFocusData().name),UiManager.getInstance().closeComponent();break;case"years":this.onSelected.call(null,this.listOptions.getFocusData().year),UiManager.getInstance().closeComponent();break;case"months":this.onSelected.call(null,this.listOptions.getFocusData().month),UiManager.getInstance().closeComponent();break;case"payments":this.account||(this.onSelected.call(null,this.listOptions.getFocusData()),UiManager.getInstance().closeComponent())}},OptionsList.prototype.unlock=function(){this.block=!1},OptionsReciveCode.prototype=Object.create(UiComponent.prototype),OptionsReciveCode.prototype.name="OptionsReciveCode",OptionsReciveCode.getInstance=function(t){return OptionsReciveCode.instance||new OptionsReciveCode(t)},OptionsReciveCode.prototype.initialize=function(){},OptionsReciveCode.prototype.render=function(t){return t?UiComponent.prototype.render.call(this):""},OptionsReciveCode.prototype.show=function(t){this.paymentSelected=t.paymentSelected,this.summary=t.summary,this.data.phone=Util.splitPhone(AppConfig.profile.callCenterInfo),this.initComponent();t=this.render(!0);$("#mainContainer").append(t),this.initList(),setTimeout(function(){$("#OptionsReciveCode").addClass("shown")},100)},OptionsReciveCode.prototype.initComponent=function(){Util.itemsRecovery().length<=0?(UiManager.getInstance().closeComponent(),UiManager.getInstance().openComponent("Error",{title:"Datos incompletos",message:"Favor de comunicarte a callcenter "+this.data.phone,button:"Cerrar",critical:!1},!1,!0)):(this.data.optionsRecovery=Util.itemsRecovery(),this.current_section="recover")},OptionsReciveCode.prototype.initList=function(t){this.optionsList=new ScrollListComponent("recovery",{maxFocusIndex:0},this.data.optionsRecovery),this.optionsList.setFocusIndex(0),this.buttonBack=this.getContainer().find(".back-arrow"),this.current_section="recover"},OptionsReciveCode.prototype.hide=function(t){var e,o=this.getContainer();o.addClass(this.hidden_class),t||((e=this).fire("hide"),(o=this.getContainer()).removeClass("shown"),this.data.optionsRecovery=null,this.optionsList=null,setTimeout(function(){e.destroy(),o.remove()},100))},OptionsReciveCode.prototype.onFocus=function(){this.getContainer(!0).removeClass("off hidden"),this.current_section="recover"},OptionsReciveCode.prototype.onBlur=function(){},OptionsReciveCode.prototype.onKeyPress=function(t){switch(t!==AppActions.menu&&t!==AppActions.back||("AddCreditCard"==UiManager.getInstance().getLastFocusComponent().name&&UiManager.getInstance().closeComponent(),UiManager.getInstance().closeComponent()),this.current_section){case"recover":this.actionHandlerRecoverNip(t);break;case"back":this.actionHandlerBtnBack(t)}},OptionsReciveCode.prototype.actionHandlerBtnBack=function(t){switch(t){case AppActions.select:UiManager.getInstance().closeComponent();break;case AppActions.moveDown:this.buttonBack.removeClass("active"),this.optionsList.setFocusIndex(),this.current_section="recover"}},OptionsReciveCode.prototype.actionHandlerRecoverNip=function(t){switch(t){case AppActions.moveUp:this.optionsList.offFocus(),this.buttonBack.addClass("active"),this.current_section="back";break;case AppActions.select:this.current_section="",this.sendCode();break;case AppActions.moveLeft:this.optionsList.previousItem();break;case AppActions.moveRight:this.optionsList.nextItem()}},OptionsReciveCode.prototype.sendCode=function(){var t=AppConfig.profile.name,e=this.optionsList.getFocusData().getSendtoCode(),e=this.optionsList.getFocusData().isPhone()?{contactInfo:e}:{contactInfo:e,name:t};UiManager.setLoading(),Totalplay.getInstance().sendPhoneCode(e).then(function(t){UiManager.removeLoading(),UiManager.getInstance().openComponent("NipComponent",{selectedItem:this.optionsList.getFocusData(),paymentSelected:this.paymentSelected,keyCode:t.secdata,summary:this.summary},!0,!0)}.bind(this),this.onError.bind(this))},OptionsReciveCode.prototype.onError=function(t){t.code;UiManager.getInstance().openComponent("Error",t)},OrderSummary.prototype=Object.create(UiComponent.prototype),OrderSummary.prototype.name="OrderSummary",OrderSummary.prototype.show=function(t){var e=Totalplay.getInstance(),o={productId:ShoppingCart.getInstance().getProductId(),requestTime:Date.now(),step:2,idAdress:""},s=this,e=e.getDetailSummary(o);UiManager.setLoading(),Promise.all([e]).then(function(t){t=t[0];return s.summary=t.summary,s.initialize(),t}).then(this.getPaymentsMethods.bind(null,o.productId)).then(function(t){s.data.idListContainer="PaymentsContainer",s.data.arrCardsPayments=t.arrCardsPayments,s.data.payments=t.payments,s.render(),ShoppingCart.getInstance().renderResume(s.name+"_Ticket"),s.getContainer(!0),s.initScrollList(),s.setSection("payments"),setTimeout(function(){$("#"+s.name).addClass("shown")},100),UiManager.removeLoading()},function(t){console.log("error",t);var e=UiManager.getInstance();console.error("Some error",t),t.onConfirm=s.onError,UiManager.removeLoading(),e.openComponent("Error",t)})},OrderSummary.prototype.onError=function(){UiManager.getInstance().closeComponent()},OrderSummary.prototype.initScrollList=function(){var t=new ScrollListComponent(this.data.idListContainer,{selector:".payment-option",maxFocusIndex:2},this.data.payments);t.setFocusIndex(0),t.offFocus(),this.payments_list=t},OrderSummary.prototype.getPaymentsMethods=function(t,e){return Totalplay.getInstance().getAllPaymentMethods(t,e.summary.id)},OrderSummary.prototype.getOrderSummary=function(t,e){var o=Totalplay.getInstance(),s=this;return o.getOrderSummary(t,e.Id).then(function(t){return s.summary=t})},OrderSummary.prototype.onFocus=function(){},OrderSummary.prototype.onBlur=function(){},OrderSummary.prototype.initialize=function(){this.data.name=AppConfig.profile.name},OrderSummary.prototype.render=function(){var t=UiComponent.prototype.render.call(this),e=ViewManager.getMainContainer();$("#"+this.name).remove(),e.append(t)},OrderSummary.prototype.hide=function(t){var e,o=this.getContainer();o.addClass(this.hidden_class),t||((e=this).fire("hide"),(o=this.getContainer()).removeClass("shown"),setTimeout(function(){e.destroy(),o.remove()},100))},OrderSummary.prototype.setSection=function(t){var e=this.current_section,o=this.getContainer();switch(this.current_section=t){case"back":this.currentSection="cardBack",this.payments_list.offFocus(),o.find("#botton-back").addClass("active"),o.find(".ticket_container").addClass("active");break;case"payments":o.find("#botton-back").removeClass("active"),o.find(".ticket_container").removeClass("active"),this.payments_list.setFocusIndex()}},OrderSummary.prototype.onReturnKeyPress=function(t){switch(t){case AppActions.select:case AppActions.back:case AppActions.menu:UiManager.getInstance().closeComponent();break;case AppActions.moveDown:this.setSection("payments")}},OrderSummary.prototype.onPaymentsKeyPress=function(t){var e;switch(t){case AppActions.moveLeft:this.payments_list.previousItem();break;case AppActions.moveRight:this.payments_list.nextItem();break;case AppActions.moveUp:this.setSection("back");break;case AppActions.select:"totalplay"==(e=this.payments_list.getFocusData()).type?UiManager.getInstance().openComponent("CreditPayment",{items:e.items,summary:this.summary},!0,!0):"card"==e.type&&UiManager.getInstance().openComponent("CardPayment",{items:this.data.arrCardsPayments,summary:this.summary},!0,!0);break;case AppActions.back:case AppActions.menu:UiManager.getInstance().closeComponent()}},OrderSummary.prototype.onKeyPress=function(t){switch(this.current_section){case"payments":this.onPaymentsKeyPress(t);break;case"back":this.onReturnKeyPress(t)}},Purchase.prototype=Object.create(UiComponent.prototype),Purchase.prototype.name="Purchase",Purchase.prototype.show=function(t){var e=ShoppingCart.getInstance(),o={},s=this,i=e.getShowsTimesData("timestamp");o.zone=e.getZonesData("name"),o.name=AppConfig.profile.name,o.event_name=e.getShowsData("name"),o.n_attendees=e.getTicketsData("noAttendees"),o.time=Helpers.getTimeFromTs(i),o.date=Helpers.dayFormatted(i),o.coupon=Util.numberWithCommas(e.getCouponsData("price")),o.show_image=e.getShowImage(),o.celebration=e.getCelebration().description,o.qr_image=t.qrImage,this.data.event_data=o,this.render(),setTimeout(function(){$("#"+s.name).addClass("shown")},120)},Purchase.prototype.render=function(){var t=UiComponent.prototype.render.call(this),e=ViewManager.getMainContainer();$("#"+this.name).remove(),e.append(t)},Purchase.prototype.initialize=function(){},Purchase.prototype.onFocus=function(){},Purchase.prototype.onBlur=function(){},Purchase.prototype.onKeyPress=function(t){switch(t){case AppActions.menu:case AppActions.back:UiManager.getInstance().closeAll();var e=ViewManager.getInstance().getCurrentView();ShoppingCart.getInstance().clearCart(),e.initialize()}},Purchase.prototype.hide=function(t){$("#"+this.name).removeClass("shown"),t||setTimeout(function(){this.getContainer(),this.destroy()}.bind(this),200)},VideoIntro.prototype=Object.create(UiComponent.prototype),VideoIntro.prototype.name="VideoIntro",VideoIntro.prototype.show=function(t){this._data=t,this.data.btnText=Util.getProp(t,"text")||"¡Compra tus boletos!";var e=Util.getProp(t,"videoIntro.url");e?(this.render(t),this.createSession(e)):this.close()},VideoIntro.prototype.render=function(t){var e=UiComponent.prototype.render.call(this),o=ViewManager.getMainContainer();$("#"+this.name).remove(),o.append(e)},VideoIntro.prototype.createSession=function(t){this.videoSession=new VideoSession(this.sessionName),this.videoSession.observe("STREAM_START",this.onStreamStart.bind(this)),this.videoSession.observe("SESSION_END",this.close.bind(this)),this.videoSession.observe("ERROR",this.onStreamError.bind(this));var e=this;this._playerTout=setTimeout(function(){clearTimeout(e._playerTout),e.videoSession.playUrl(t)},0)},VideoIntro.prototype.onStreamStart=function(){this.videoSession.stopEventObserving("STREAM_START")},VideoIntro.prototype.onStreamError=function(){this.close()},VideoIntro.prototype.close=function(){UiManager.getInstance().openComponent("LandingPage",this._data.shows,!0,!1,!1)},VideoIntro.prototype.onKeyPress=function(t){t===AppActions.select&&this.close()},VideoIntro.prototype.onBlur=function(){console.log("onBlur")},VideoIntro.prototype.onFocus=function(){},VideoIntro.prototype.hide=function(t){this.videoSession&&(this.videoSession.deleteSession(),this.videoSession.stopEventObserving("ERROR"),this.videoSession.stopEventObserving("STREAM_START"),this.videoSession.stopEventObserving("SESSION_END"),this.videoSession=null);var e=this.getContainer(!0);e.empty(),e.remove()};